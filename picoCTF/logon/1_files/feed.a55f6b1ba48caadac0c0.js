!function(e){function t(t){for(var i,r,a=t[0],c=t[1],l=t[2],u=0,h=[];u<a.length;u++)r=a[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&h.push(n[r][0]),n[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(d&&d(t);h.length;)h.shift()();return s.push.apply(s,l||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],i=!0,a=1;a<o.length;a++){var c=o[a];0!==n[c]&&(i=!1)}i&&(s.splice(t--,1),e=r(r.s=o[0]))}return e}var i={},n={"web/feed":0},s=[];function r(t){if(i[t])return i[t].exports;var o=i[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(){return Promise.resolve()},r.m=e,r.c=i,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(o,i,function(t){return e[t]}.bind(null,i));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/js/cmodules/";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var d=c;s.push([173,"common","87e53d18c97a21833435b4d03c8ffead","c6f51c78d2a3f17f935b490330a9da66","2cf5ed18a362f0799fb455ece038a3f1","d14210db89a37ef97acca2f934f28b98"]),o()}({"/bCM":function(e,t,o){"use strict";o.r(t),o.d(t,"REACTION_ID_DEFAULT",(function(){return i})),o.d(t,"REACTION_ID_MAX",(function(){return n})),o.d(t,"REACTION_ID_MIN",(function(){return s})),o.d(t,"REACTION_SET_ITEMS_MIN_COUNT",(function(){return r}));var i=0,n=7,s=0,r=2},173:function(e,t,o){e.exports=o("e/IV")},"9I9X":function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"evalWithLogging",(function(){return evalWithLogging}));var _web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("98sY"),evalWithLogging=evalString=>{try{return eval(evalString)}catch(e){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__.logEvalError)(e,evalString)}}},QxcO:function(e,t,o){"use strict";o.r(t),o.d(t,"getReactionsButtonTemplateBase",(function(){return c})),o.d(t,"getReactionsButtonPostTemplate",(function(){return d})),o.d(t,"getReactionsButtonReplyTemplate",(function(){return u})),o.d(t,"likeDataReactionsFields",(function(){return f}));var i=o("W9Tc"),n=o("zxIV"),s=o("pruO"),r=o("crIy"),a=o("fBgk"),c=function(e,t){var o,s=null===(o=function(e){try{var t=JSON.parse(e);if(null!==t&&"object"!=typeof t)return;return t}catch(e){return}}(e))||void 0===o?void 0:o.set_id,c="string"==typeof s?s:void 0;if(Object(i.partConfigEnabled)("reactions_enabled")&&t&&c){var l=Object(r.getReactionSet)(c);if(l)return{likeClassName:"like_btn--hidden",template:Object(n.rs)(t,{reactions_button_title:Object(a.getDefaultReactionTitle)(l)||"",reactions_set_id:c})}}},l=function(e,t){return t.length>e},d=function(e,t){var o,i=null===(o=null==t?void 0:t.wallTpl)||void 0===o?void 0:o.post_likes_reactions,n=l(14,e)?e[14]:void 0;if("string"==typeof n)return c(n,i)},u=function(e,t){var o,n=null===(o=null==t?void 0:t.wallTpl)||void 0===o?void 0:o.reply_likes_reactions;if(Object(i.partConfigEnabled)("reactions_enabled_post_replies")){var s=l(14,e)?e[14]:void 0;if("string"==typeof s)return c(s,n)}},h=function(e){var t=JSON.parse(e);if(null===t||"object"==typeof t||Array.isArray(t)){var o;if(Array.isArray(t))t=(o=t,Object.assign(Object.create(null),o));return t}},p=function(e){if(Object(i.partConfigEnabled)("reactions_enabled")){var t=l(5,e)?e[5]:void 0;if("string"==typeof t){var o=function(e){var t=e.indexOf(";"),o=e.substr(0,t),i=e.substr(t+1);if("1"===o)return h(i)}(t);if(o)return{counts:o}}}},f=function(e){var t,o=p(e);return(t={})[s.REACTIONS_COUNTS_RESPONSE_FIELD]=null==o?void 0:o.counts,t}},Rafy:function(e,t,o){"use strict";o.r(t),o.d(t,"DEBUG_ENABLED",(function(){return i}));var i=!!o("Xrg9").default.get("reactions.debug_enabled")},crIy:function(e,t,o){"use strict";o.r(t),o.d(t,"storageAddSets",(function(){return u})),o.d(t,"getReactionSet",(function(){return h}));var i=o("HLtZ"),n=o("fBgk"),s=o("Rafy"),r=o("qYuU"),a=o("pruO"),c=o("vkmG"),l=function(){return(l=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},d=Object(r.makeSharedState)("reactions-storage",(function(){return new Map})),u=function(e){s.DEBUG_ENABLED&&console.log(e),Object.entries(e).forEach((function(e){var t=e[0],o=e[1],s=Object(n.validateReactionSetPayloaditems)(o,t);if(s)Object(i.logError)(s.error);else{var r=o.map((function(e){return l(l({},e),{title:Object(c.decodeHTMLEntities)(e.title)})}));d().set(t,Object(n.prepareReactionMenuSet)(t,r,{imageMenuSize:a.SIZE_MENU,imagePreviewSize:a.SIZE_PREVIEW}))}}))},h=function(e){var t=d().get(e);if(!t){var o=new Error("Reaction set not found: "+e);return Object(i.logError)(o,{environment:"reactions"}),void console.error(o)}return t}},dBLD:function(e,t,o){"use strict";var i;o.r(t),o.d(t,"TagEventTypes",(function(){return i})),function(e){e.CONFIRM_SUGGESTED_TAGS="CONFIRM_SUGGESTED_TAGS",e.DECLINE_SUGGESTED_TAGS="DECLINE_SUGGESTED_TAGS",e.DECLINE_USER_TAG="DECLINE_USER_TAG",e.CONFIRM_USER_TAG="CONFIRM_USER_TAG",e.DELETE_TAG="DELETE_TAG"}(i||(i={}))},"e/IV":function(e,t,o){"use strict";o.r(t);o("91GP"),o("VRzm"),o("Btvt"),o("Vd3H"),o("OG14"),o("pIFo"),o("SRfc"),o("KKXr");var i,n=o("D1OX"),s=o("zxIV"),r=o("9I9X"),a=o("o7bv"),c=o("v+DW"),l=o("EasH"),d=o("FWc3"),u=o("t/FQ"),h=o("XzvV"),p=o("t7n3"),f=o("2vnv"),_=o("QxcO"),g=o("rwc4"),v=o("BJj/"),m=o("jE6c"),w=o("zuld"),b=e=>{for(var t=indexOf(domPN(e).children,e),o=domFC(e);o&&"moat"===o.id.slice(0,4);)o=domNS(o);var i,n,s,r=/^post(-?\d+_\d+)$/,a={};if(!o)return a;if("ads_feed_placeholder"===o.id)return a;a.module=cur.module,a.index=t,"feed"==cur.module&&("search"==cur.section?(a.module="feed_search",a.q=cur.q):"news"==cur.section?a.module=cur.subsection?"feed_news_"+cur.subsection:"feed_news":"recommended"==cur.section?a.module=cur.subsection?"feed_recommended_"+cur.subsection:"feed_recommended":"friends"==cur.section?a.module=cur.subsection?"feed_friends_"+cur.subsection:"feed_friends":"groups"==cur.section?a.module=cur.subsection?"feed_groups_"+cur.subsection:"feed_groups":"videos"==cur.section?a.module=cur.subsection?"feed_videos_"+cur.subsection:"feed_videos":"photos"==cur.section?a.module=cur.subsection?"feed_photos_"+cur.subsection:"feed_photos":"podcasts"==cur.section?a.module=cur.subsection?"feed_podcasts_"+cur.subsection:"feed_podcasts":"list"==cur.section?a.module=cur.subsection?"feed_list_"+cur.subsection:"feed_list":a.module="feed_other");var c=o.getAttribute("data-ad-view");c&&(a["ad_"+c]=1);var l=o.getAttribute("post_view_hash");if(l&&(a.hash=l),"block_"===o.id.substr(0,6)){a[o.id]=1,a.block=o.id.substr(6);var d=attr(o,"data-contain");d&&(d=d.split(",")).forEach((function(e){e=e.split(":"),a[e[0]]=intval(e[1])||1}));var u=attr(o,"data-contain-ids");u&&(a.contain_ids=u)}else if(n=o.id.match(r))a[n[1]]=1;else if(n=o.id.match(/^post(adsite.*)$/))a[n[1]]=1;else if(n=(i=o.className).match(/feed_reposts_wrap(-?\d+_\d+)/)){if(s=domFC(o),hasClass(domFC(s),"post_copy")&&(a[n[1]]=-1),(n=domFC(s).id.match(r))&&(a[n[1]]=1),isVisible(s=domNS(s)))for(s=domFC(s);s;s=domNS(s))(n=s.id.match(r))&&(a[n[1]]=1)}else if(n=i.match(/feed_repost(-?\d+_\d+)/))s=domFC(o),hasClass(s,"post_copy")&&(a[n[1]]=-1),(n=s.id.match(r))&&(a[n[1]]=1);else{var h=o.id;hasClass(o,"post_photos")&&(s=geByClass1("post_image",o,"a"))&&(s=domFC(s))&&(n=s.getAttribute("data-post-id").match(/^(-?\d+_p?\d+)$/))&&(h=n[1]),a[h]=1}return a},y=e=>{var t=e&&domFC(e);return t&&t.hasAttribute("data-ad-video-autoplay")},k=e=>{var t=e&&domFC(e);return t&&t.hasAttribute("data-ad-views-long-only")},C=((e,t)=>{var o,i=!1;return function(){return!0===i||(o=e(...arguments),i=t(o)),o}})(()=>ge("page_header").offsetHeight,e=>!!e);!function(e){e.MarketItems="block_market-items",e.PhotoRecognize="tags_suggestions"}(i||(i={}));var E,O,P={tracking:[],viewed:{}},L=(e,t)=>{var o=P.tracking,i=P.viewed;if(0===o.length)return[];var n=[];return each(o,(function(o,s){var r=domFC(s),a=r.id;if(r&&a){var c=domData(r,"ad-block-uid"),l=""+a;if(c&&(l+="_"+c),!i[l]&&document.body.contains(s))if(((e,t,o,i)=>{var n=C(),s=o+n,r=o+i,a=e.offsetHeight,c=e.offsetTop+n,l=c+a;return(l>s&&c<r?(Math.min(r,l)-Math.max(s,c))/a:0)>=t})(s,.5,e,t)){var d=Date.now();s.longViewStartedAt?d-s.longViewStartedAt>=1e3&&(i[l]=!0,n.push(extend({},b(s),{long:1}))):s.longViewStartedAt=Date.now()}else s.longViewStartedAt=null}})),n},T=e=>!!e&&(!!e.longViewTracking||!e.longViewRegistered&&(e.longViewRegistered=!0,e.longViewTracking=y(e)||(e=>{var t=e&&domFC(e);return t&&(t.hasAttribute("data-ad-stat-impression_long")||t.hasAttribute("data-ad-disabled-stat-impression_long"))})(e)||k(e),!!e.longViewTracking&&(P.tracking.push(e),!0))),j=o("Bj12"),B=o("/PiP"),S={market:"al_market.php"},I={getNewMarketItemsBox:"get_new_items_box"},x="#feed_rows",R=".feed_row",A={showItem:function(e,t,o,i){e&&(Object(B.showWiki)({w:"product"+e,from:"feed"}),A.logClick(t,o,i,e))},showAll:function(e,t,o){Object(l.showBox)(S.market,{act:I.getNewMarketItemsBox},{params:{hideButtons:!0,width:550,grey:!0,containerClass:"MarketItemsFeedBlockBox",bodyStyle:"padding: 20px 0 0;",onHide:function(){var e,t;return null===(t=null===(e=window.Marketplace)||void 0===e?void 0:e.scroll)||void 0===t?void 0:t.deinit()}}}),A.logClick(e,t,o)},logClick:function(e,t,o,i){var n;if(e&&t&&o){var s=(null===(n=window.Feed)||void 0===n?void 0:n.getModuleRef())||"",r=e.closest(x),a=r?Array.from(r.children):[],c=e.closest(R),l=c?a.indexOf(c):0,d=window.cur.feed_session_id||0;Object(j.saveStatlogEvents)({name:t,value:o,keys:[s,l,d,i||""]})}}},D="PhotoCarousel__arrowWrapper--hidden",M=function(){function e(e,t,o){var i=this;this.activeItemIdx=0,this.onLeftArrowClick=function(e){var t;i.isLeftBtnDisabled?e.stopPropagation():((null===(t=i.options)||void 0===t?void 0:t.onPrevClick)&&i.options.onPrevClick(e),i.prev())},this.onRightArrowClick=function(e){var t,o;i.isRightBtnDisabled?e.stopPropagation():((null===(t=i.options)||void 0===t?void 0:t.onNextClick)&&(null===(o=i.options)||void 0===o||o.onNextClick(e)),i.next())},this.post=e,this.options=o,this.items=t;var n=e.querySelector(".PhotoCarousel"),r=e.querySelector(".PhotoCarousel__arrowWrapper--left"),a=e.querySelector(".PhotoCarousel__arrowWrapper--right"),c=e.querySelector(".PhotoCarousel__items");if(!n||!c)throw new Error("PhotoCarousel: incorrect arguments");var l=Object(s.getSize)(c)[0],d=Object(s.getSize)(n)[0];this.carousel=n,this.leftArrowBtn=r,this.rightArrowBtn=a,this.isLeftBtnDisabled=!r||r.classList.contains(D),this.isRightBtnDisabled=!a||a.classList.contains(D),this.photoList=c,this.photoListWidth=l,this.carouselWidth=d,this.activeItemIdx=this.getActiveItemIdxFromDOM(),this.initListeners()}return e.prototype.destroy=function(){this.deInitListeners()},e.prototype.initListeners=function(){this.leftArrowBtn&&this.leftArrowBtn.addEventListener("click",this.onLeftArrowClick),this.rightArrowBtn&&this.rightArrowBtn.addEventListener("click",this.onRightArrowClick)},e.prototype.deInitListeners=function(){this.leftArrowBtn&&this.leftArrowBtn.removeEventListener("click",this.onLeftArrowClick),this.rightArrowBtn&&this.rightArrowBtn.removeEventListener("click",this.onRightArrowClick)},e.prototype.next=function(){this.move(this.getActiveIdx()+1)},e.prototype.prev=function(){this.move(this.getActiveIdx()-1)},e.prototype.getActive=function(){return this.items[this.activeItemIdx]},e.prototype.getActiveIdx=function(){return this.activeItemIdx},e.prototype.getActiveItemIdxFromDOM=function(){return Number(this.carousel.dataset.idx)},e.prototype.move=function(e){var t,o=this.getActiveIdx(),i=this.getActive(),n=this.items[e];if(n){var r=n.getEl();if(this.rightArrowBtn&&this.leftArrowBtn){var a=n.getPhotoRawId(),c=Object(s.getSize)(r)[0],l=r.offsetLeft,d=Math.round(this.photoListWidth-this.carouselWidth),u=l+c/2-this.carouselWidth/2;if(e>o)u=Math.min(u,d);else{if(!(e<o))return;u=Math.max(u,0)}u=Math.round(u),this.photoList.style.transform="translateX(-"+u+"px)";var h=(this.carouselWidth-c-12)/2,p=this.carouselWidth-c-20-6;u?(this.toggleLeftBtnDisabled(!1),this.leftArrowBtn.style.width=u===d?p+"px":h+"px"):this.toggleLeftBtnDisabled(!0),u===d?this.toggleRightBtnDisabled(!0):(this.toggleRightBtnDisabled(!1),this.rightArrowBtn.style.width=u?h+"px":p+"px"),i.setActive(!1),n.setActive(),this.activeItemIdx=e,this.items.slice(e,e+4).forEach((function(e){return e.init()})),this.carousel.setAttribute("data-idx",String(e)),this.post.setAttribute("data-photo-raw-id",String(a)),(null===(t=this.options)||void 0===t?void 0:t.onChange)&&this.options.onChange()}}},e.prototype.toggleLeftBtnDisabled=function(e){void 0===e&&(e=!0),this.leftArrowBtn&&(e?(this.leftArrowBtn.classList.add(D),this.isLeftBtnDisabled=!0):(this.leftArrowBtn.classList.remove(D),this.isLeftBtnDisabled=!1))},e.prototype.toggleRightBtnDisabled=function(e){void 0===e&&(e=!0),this.rightArrowBtn&&(e?(this.rightArrowBtn.classList.add(D),this.isRightBtnDisabled=!0):(this.rightArrowBtn.classList.remove(D),this.isRightBtnDisabled=!1))},e}(),N=o("smNX"),H=function(){function e(e){this.item=e;var t=e.querySelector(".PhotoCarouselImage"),o=e.dataset.photoViewOptions||"",i=e.dataset.photoContext,n=e.dataset.photoRawId,s=o&&Object(N.parseJSON)(o);if(!(s&&n&&i&&t))throw new Error("PhotoCarouselBlockItem: incorrect arguments");var r=n.split("_"),a=r[0],c=r[1];this.ownerId=Number(a),this.photoId=Number(c),this.photoRawId=n,this.photoContext=i,this.photoViewOptions=s,this.photo=t,this.isActive=e.classList.contains("PhotoCarouselItem--active")}return e.prototype.setActive=function(e){void 0===e&&(e=!0),this.isActive=e,this.item.classList.toggle("PhotoCarouselItem--active",e)},e.prototype.init=function(){var e=this.item.getAttribute("data-photo-url");if(e){if(this.item.classList.contains("PhotoCarouselItem--noSize")){var t=this.item.querySelector(".PhotoCarouselItem__stub");t&&(t.src=e)}else{var o=this.item.querySelector(".PhotoCarouselImage");if(!o)return;o.style.backgroundImage="url('"+e+"')"}this.item.removeAttribute("data-photo-url")}},e.prototype.getPhotoRawId=function(){return this.photoRawId},e.prototype.getOwnerId=function(){return this.ownerId},e.prototype.getEl=function(){return this.item},e}(),F=o("aong"),q=o("nTq2"),V=o("Egk5"),U=(E=function(e,t){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),G=function(e){function t(t,o){var i=e.call(this,t)||this;i.onPhotoClick=function(e){var t;e.ctrlKey||e.metaKey||(i.showPhoto(e),(null===(t=i.options)||void 0===t?void 0:t.sendAnalytic)&&i.options.sendAnalytic("open_photo"))},i.onShareClick=function(e){var t;if(i.objectRawId){var o=null===(t=i.options)||void 0===t?void 0:t.sendAnalytic;o&&(o("click_to_sharing",e),window.cur.sbOnShare=function(){o("repost",e)}),q.Likes.share(i.objectRawId,i.shareOptions),Object(V.cancelEvent)(e)}},i.onCommentsClick=function(e){var t,o=i.photoViewOptions||{};o.commentFocusInit=!0,i.showPhoto(e,o);var n=null===(t=i.options)||void 0===t?void 0:t.sendAnalytic;n&&n("click_to_comment",e)},i.onLikeClick=function(e){var t;if(i.likeBtn&&i.objectRawId&&i.likeHash){var o=i.isLiked()?"unlike":"like",n=null===(t=i.options)||void 0===t?void 0:t.sendAnalytic;n&&n(o,e),q.Likes.toggle(i.likeBtn,e,i.objectRawId,i.likeHash)}},i.isLiked=function(){return i.likeBtn&&i.likeBtn.classList.contains("active")},i.options=o,i.shareBtn=t.querySelector("._share"),i.commentsBtn=t.querySelector("._comment"),i.likeBtn=t.querySelector("._like"),i.objectRawId=t.dataset.objectRawId,i.likeHash=t.dataset.likeHash;var n=t.dataset.shareOptions||"";return i.shareOptions=n&&Object(F.parseJSON)(n),i.initListeners(),i}return U(t,e),t.prototype.destroy=function(){this.deInitListeners()},t.prototype.initListeners=function(){this.shareBtn&&this.shareBtn.addEventListener("click",this.onShareClick),this.commentsBtn&&this.commentsBtn.addEventListener("click",this.onCommentsClick),this.likeBtn&&this.likeBtn.addEventListener("click",this.onLikeClick),this.photo.addEventListener("click",this.onPhotoClick)},t.prototype.deInitListeners=function(){this.shareBtn&&this.shareBtn.removeEventListener("click",this.onShareClick),this.commentsBtn&&this.commentsBtn.removeEventListener("click",this.onCommentsClick),this.likeBtn&&this.likeBtn.removeEventListener("click",this.onLikeClick),this.photo.removeEventListener("click",this.onPhotoClick)},t.prototype.showPhoto=function(e,t){void 0===t&&(t=this.photoViewOptions),Object(B.showPhoto)(this.photoRawId,this.photoContext,t,e),Object(V.cancelEvent)(e)},t}(H),W=function(){function e(e,t){var o,i=this;this.isDestroyed=!1,this.destroy=function(){i.isDestroyed||(i.deInitListener(),i.carousel.destroy(),i.items.forEach((function(e){return e.destroy()})),i.isDestroyed=!0)},this.onPostClick=function(e){var t,o=e.target;(null===(t=i.blockOptions)||void 0===t?void 0:t.sendAnalytic)&&(o.classList.contains("post_img")||o.classList.contains("author")||o.classList.contains("mem_link")||o.classList.contains("PhotoCarouselBlockItem__avatar")?i.blockOptions.sendAnalytic("open_user",i.post,e):o.classList.contains("PhotoCarouselImage")||o.classList.contains("PhotoCarouselItem__stub")||o.classList.contains("page_post_thumb_wrap")?i.blockOptions.sendAnalytic("open_photo",i.post,e):o.classList.contains("PhotoCarousel__hidePost")&&i.blockOptions.sendAnalytic("hide",i.post,e))},this.post=e,this.blockOptions=t;var n=this.getCarouselOptions();this.items=this.createItems(e),this.carousel=new M(e,this.items,n),this.initListeners(),null===(o=window.cur.destroy)||void 0===o||o.push(this.destroy)}return e.prototype.initListeners=function(){this.post.addEventListener("click",this.onPostClick)},e.prototype.deInitListener=function(){this.post.removeEventListener("click",this.onPostClick)},e.prototype.createItems=function(e){var t,o=this,i=Array.from(e.querySelectorAll(".PhotoCarouselItem")),n={};return(null===(t=this.blockOptions)||void 0===t?void 0:t.sendAnalytic)&&(n.sendAnalytic=function(e,t){var i,n;(null===(i=o.blockOptions)||void 0===i?void 0:i.sendAnalytic)&&(null===(n=o.blockOptions)||void 0===n||n.sendAnalytic(e,o.post,t))}),i.map((function(e){return new G(e,n)}))},e.prototype.getCarouselOptions=function(){var e,t=this,o=null===(e=this.blockOptions)||void 0===e?void 0:e.sendAnalytic;return{onPrevClick:function(e){o&&o("click_previous",t.post,e)},onNextClick:function(e){o&&o("click_next",t.post,e)}}},e}();!function(e){e[e.ME=1]="ME",e[e.FRIEND=2]="FRIEND",e[e.ALL=3]="ALL"}(O||(O={}));var z=o("HLtZ"),Y=o("YoAk"),X=o("Nk8j"),Q=o("4+be"),K=o("W9Tc"),J=o("DM2o"),$=function(){return($=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function Z(e,t,o){void 0===t&&(t=""),void 0===o&&(o={});var i=$({event_type:e,track_code:t},o);Object(J.statlogsValueEvent)("photo_recognition_stat",i)}var ee,te=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();!function(e){e[e.CONFIRMED=0]="CONFIRMED",e[e.DECLINED=1]="DECLINED",e[e.DELETED=2]="DELETED"}(ee||(ee={}));var oe=function(e){function t(t,o){var i=e.call(this,t)||this;i.isLoading=!1,i.isSkipped=!1,i.onShowAllClick=function(e){i.showPhoto(e),i.sendAnalytic("show_tags")},i.onPhotoClick=function(e){e.ctrlKey||e.metaKey||(i.showPhoto(e),Object(V.cancelEvent)(e))},i.onConfirmClick=function(){if(!i.isLoading){var e=i.getTags();i.isLoading=!0,i.tagArea.confirmSuggestedTags(e,i,i.confirmBtn).then((function(){i.updatePhotoviewCache(!0),i.incrementConfirmedCount(e.length),i.showResultPanel(ee.CONFIRMED),i.block.nextWithDelay()}),(function(e){e&&Object(z.logError)(e)})).finally((function(){i.isLoading=!1}))}},i.onDeclineClick=function(){i.isLoading||(i.isLoading=!0,i.tagArea.declineSuggestedTags(i.getTags(),i,i.declineBtn).then((function(){i.updatePhotoviewCache(!0),i.showResultPanel(ee.DECLINED),i.block.nextWithDelay()})).finally((function(){i.isLoading=!1})))},i.onCancelClick=function(){i.cancelBtn&&(i.reset(),i.showSuggestPanel())},i.onNextClick=function(){i.skipTags(),i.block.next()};var n=t.dataset.tagHash||"";return i.block=o,i.type=Number(t.dataset.recognizeType),i.title=t.dataset.title,i.trackCode=t.dataset.trackCode||"",i.skipHash=t.dataset.skipHash||"",i.confirmBtn=t.querySelector(".PhotoRecognizeBlockItem__btn--confirm"),i.declineBtn=t.querySelector(".PhotoRecognizeBlockItem__btn--decline"),i.showAllBtn=t.querySelector(".PhotoRecognizeBlockItem__btn--showTags"),i.nextBtn=t.querySelector(".PhotoRecognizeBlockItem__btn--next"),i.description=t.querySelector(".PhotoRecognizeBlockItem__description"),i.tagArea=new Y.PhotoTagArea(i,n,i.trackCode),i.initListeners(),i}return te(t,e),t.prototype.destroy=function(){this.deInitListeners()},t.prototype.skipTags=function(){this.isSkipped||(this.isSkipped=!0,window.ajax.post("al_photos.php",{act:"skip_suggested_tags",tag_raw_ids:this.tagArea.getFullRawTagIdsStr(),photo_raw_id:this.getPhotoRawId(),track_code:this.trackCode,hash:this.skipHash},{onDone:function(){},onFail:function(e){return!!Object(K.partConfigEnabled)("recognize_mock_turn_off")&&e&&Object(z.logError)(e),!0}}))},t.prototype.initListeners=function(){var e,t,o,i,n;null===(e=this.confirmBtn)||void 0===e||e.addEventListener("click",this.onConfirmClick),null===(t=this.declineBtn)||void 0===t||t.addEventListener("click",this.onDeclineClick),null===(o=this.cancelBtn)||void 0===o||o.addEventListener("click",this.onDeclineClick),null===(i=this.showAllBtn)||void 0===i||i.addEventListener("click",this.onShowAllClick),null===(n=this.nextBtn)||void 0===n||n.addEventListener("click",this.onNextClick),this.photo.addEventListener("click",this.onPhotoClick)},t.prototype.deInitListeners=function(){var e,t,o,i,n;null===(e=this.confirmBtn)||void 0===e||e.removeEventListener("click",this.onConfirmClick),null===(t=this.declineBtn)||void 0===t||t.removeEventListener("click",this.onDeclineClick),null===(o=this.showAllBtn)||void 0===o||o.removeEventListener("click",this.onShowAllClick),null===(i=this.nextBtn)||void 0===i||i.removeEventListener("click",this.onNextClick),null===(n=this.cancelBtn)||void 0===n||n.removeEventListener("click",this.onCancelClick),this.photo.removeEventListener("click",this.onPhotoClick)},t.prototype.showPhoto=function(e){Object(B.showPhoto)(this.photoRawId,this.photoContext,this.photoViewOptions,e),this.updatePhotoviewCache()},t.prototype.updatePhotoviewCache=function(e){void 0===e&&(e=!1),this.photoViewOptions.noCache=e,e&&Object(X.dropPhotoCacheData)()},t.prototype.showResultPanel=function(e){var t;if(this.description){var o=this.getResultText(e);this.resultPanel||this.createResultPanel();var i=null===(t=this.resultPanel)||void 0===t?void 0:t.querySelector(".PhotoRecognizeBlockItem__resultMessage");if(!i||!this.resultPanel)throw new Error("PhotoRecognizeBlockItem: can not get text element");this.resultPanel.classList.toggle("PhotoRecognizeBlockItem__resultPanel--confirmed",e===ee.CONFIRMED),i.innerHTML=o,Object(s.hide)(this.description),Object(s.show)(this.resultPanel)}},t.prototype.showSuggestPanel=function(){Object(s.hide)(this.resultPanel),Object(s.show)(this.description)},t.prototype.getResultText=function(e){var t=this.getOwnerId(),o=this.getConfirmedTags(),i=this.getTags()[0],n=i.getUserId(),s=i.getOwnerNameGenitive(),r=i.getUserNameAccusative(),a="";switch(e){case ee.CONFIRMED:this.type===O.ME?a=t===n?Object(Q.getLang)("photo_recognition_confirm_me_on_my_photo"):(a=t>0?Object(Q.getLang)("photo_recognition_confirm_myself_on_photo"):Object(Q.getLang)("photo_recognition_confirm_myself_on_photo_group")).replace("{name}",s):this.type===O.FRIEND?a=t===n?Object(Q.getLang)("photo_recognition_confirm_on_photo").replace("{name}",s):(a=(a=t>0?Object(Q.getLang)("photo_recognition_confirm_friend_on_photo"):Object(Q.getLang)("photo_recognition_confirm_friend_on_photo_group")).replace("{name1}",r)).replace("{name2}",s):this.type===O.ALL&&(a=Object(Q.getLang)("photo_recognition_confirm_n_friends_on_photo",o.length));break;case ee.DECLINED:a=this.type===O.ALL?o.length?Object(Q.getLang)("photo_recognition_confirm_n_friends_on_photo",o.length):Object(Q.getLang)("photo_recognition_decline_n_friends_on_photo",o.length):(a=t>0?Object(Q.getLang)("photo_recognition_decline_on_photo"):Object(Q.getLang)("photo_recognition_decline_on_photo_group")).replace("{name}",s);break;default:a=Object(Q.getLang)("photo_recognition_deleted_tag")}return a},t.prototype.createResultPanel=function(){this.resultPanel=document.createElement("div"),this.resultPanel.classList.add("PhotoRecognizeBlockItem__resultPanel");var e=document.createElement("span");e.classList.add("PhotoRecognizeBlockItem__resultMessage"),this.resultPanel.appendChild(e);var t=this.item.querySelector(".PhotoRecognizeBlockItem__footerWrapper");t&&t.appendChild(this.resultPanel)},t.prototype.setConfirmedTagsByIds=function(e){this.tagArea.setConfirmedTagsByIds(e)&&(this.showResultPanel(ee.CONFIRMED),this.incrementConfirmedCount(e.length))},t.prototype.setDeclinedTagsByIds=function(e){this.tagArea.setDeclinedTagsByIds(e)&&this.showResultPanel(ee.DECLINED)},t.prototype.setDeletedTagsByIds=function(e){this.tagArea.setDeclinedTagsByIds(e)&&this.showResultPanel(ee.DELETED)},t.prototype.reset=function(){this.tagArea.reset()},t.prototype.getTitle=function(){return this.title},t.prototype.getTags=function(){return this.tagArea.getTags()},t.prototype.getConfirmedTags=function(){return this.tagArea.getConfirmedTags()},t.prototype.incrementConfirmedCount=function(e){void 0===e&&(e=1),this.block.incrementConfirmedCount(e)},t.prototype.init=function(){var t=this.item.getAttribute("data-photo-url");t&&(e.prototype.init.call(this),this.checkItemHasNoSizes()&&this.correctTagView(t))},t.prototype.checkItemHasNoSizes=function(){return this.item.classList.contains("PhotoCarouselItem--noSize")},t.prototype.correctTagView=function(e){var t=this,o=new Image;o.onload=function(){var i=o.width,n=o.height;if(i&&n){var s=t.item.querySelector(".PhotoRecognizeBlockItem__photoFrame");if(!s)return;var r=Y.PhotoTagArea.calculateTagAreaSizes(s,i,n),a=r[0],c=r[1],l=t.item.querySelector(".PhotoCarouselImage");if(!l)return;var d=t.item.querySelector(".PhotoCarouselItem__stub");d&&d.remove(),l.style.backgroundSize=a+"px "+c+"px",l.style.backgroundImage="url('"+e+"')";var u=a+1,h=c+1;t.tagArea.setSizes(u,h),t.tagArea.show(),t.item.classList.remove("PhotoCarouselItem--noSize")}},o.src=e},t.prototype.sendAnalytic=function(e,t){void 0===t&&(t={}),Z(e,this.trackCode,t)},t}(H),ie=o("kcIO"),ne=o("dBLD"),re=function(){function e(e){var t,o=this;this.isDestroyed=!1,this.countConfirmedTags=0,this.destroy=function(){o.isDestroyed||(o.nextPhotoTimerId&&(clearTimeout(o.nextPhotoTimerId),o.nextPhotoTimerId=null),o.deInitListeners(),o.carousel.destroy(),o.items.forEach((function(e){return e.destroy()})),o.isDestroyed=!0)},this.handleOutsideConfirmationTags=function(e){var t=e.detail.photoRawId,i=e.detail.tagIds;o.items.filter((function(e){return e.getPhotoRawId()===t})).forEach((function(e){return e.setConfirmedTagsByIds(i)}))},this.handleOutsideDeclinationTags=function(e){var t=e.detail.photoRawId,i=e.detail.tagIds;o.items.filter((function(e){return e.getPhotoRawId()===t})).forEach((function(e){return e.setDeclinedTagsByIds(i)}))},this.handleOutsideDeletingTags=function(e){var t=e.detail.photoRawId,i=e.detail.tagIds;o.items.filter((function(e){return e.getPhotoRawId()===t})).forEach((function(e){return e.setDeletedTagsByIds(i)}))},this.next=function(){o.nextPhotoTimerId&&(clearTimeout(o.nextPhotoTimerId),o.nextPhotoTimerId=null),o.carousel.getActiveIdx()!==o.items.length-1?o.carousel.next():o.countConfirmedTags?o.showEndCard():(o.removeBlock(),o.showThanksNotification())},this.removeBlock=function(){o.destroy(),o.post.remove()},this.onPhotoChangeClick=function(){o.nextPhotoTimerId&&(clearTimeout(o.nextPhotoTimerId),o.nextPhotoTimerId=null),o.skipActiveItemTags()},this.updateBlockTitle=function(){if(o.titleEl){var e=o.carousel.getActive().getTitle();e&&(o.titleEl.innerHTML=e)}},this.hideHelpHintClick=function(e){o.hintHelpId&&o.hintHelpHash&&(Object(V.cancelEvent)(e),window.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:o.hintHelpId,hash:o.hintHelpHash},{onDone:function(){var e;null===(e=o.hintHelpPanel)||void 0===e||e.remove()},onFail:function(){return console.error("something wrong with help hint"),!0}}))},this.post=e,this.titleEl=e.querySelector(".PhotoRecognizeBlock__title");var i=e.querySelector(".PhotoRecognizeBlock__inner");if(!i)throw new Error("PhotoRecognizeBlock: there is not inner");this.trackCode=e.dataset.trackCode,this.hintHelpId=e.dataset.hintHelpId,this.hintHelpHash=e.dataset.hintHelpHash,this.innerWrapperEl=i,this.items=this.createItems(e),this.carousel=new M(e,this.items,{onPrevClick:this.onPhotoChangeClick,onNextClick:this.onPhotoChangeClick,onChange:this.updateBlockTitle}),this.hintHelpPanel=e.querySelector(".PhotoRecognizeBlockHint"),this.helpHintPanelHideBtn=e.querySelector(".PhotoRecognizeBlockHint__hide"),this.initListeners(),this.initFirstItems(),null===(t=window.cur.destroy)||void 0===t||t.push(this.destroy),window.cur.pvOneSuggestHintId=e.dataset.hintAlertId,window.cur.pvOneSuggestHintHash=e.dataset.hintAlertHash,null==window.cur.pvNeedShowAlertForOneSuggest&&(window.cur.pvNeedShowAlertForOneSuggest=Boolean(Number(e.dataset.needShowAlert)))}return e.prototype.initListeners=function(){var e;document.addEventListener(ne.TagEventTypes.CONFIRM_SUGGESTED_TAGS,this.handleOutsideConfirmationTags),document.addEventListener(ne.TagEventTypes.DECLINE_SUGGESTED_TAGS,this.handleOutsideDeclinationTags),document.addEventListener(ne.TagEventTypes.DELETE_TAG,this.handleOutsideDeletingTags),null===(e=this.helpHintPanelHideBtn)||void 0===e||e.addEventListener("click",this.hideHelpHintClick)},e.prototype.deInitListeners=function(){var e,t;null===(e=this.closeEl)||void 0===e||e.removeEventListener("click",this.removeBlock),null===(t=this.helpHintPanelHideBtn)||void 0===t||t.removeEventListener("click",this.hideHelpHintClick),document.removeEventListener(ne.TagEventTypes.CONFIRM_SUGGESTED_TAGS,this.handleOutsideConfirmationTags),document.removeEventListener(ne.TagEventTypes.DECLINE_SUGGESTED_TAGS,this.handleOutsideDeclinationTags),document.removeEventListener(ne.TagEventTypes.DELETE_TAG,this.handleOutsideDeletingTags)},e.prototype.initFirstItems=function(){this.items.slice(0,4).forEach((function(e){return e.init()}))},e.prototype.createItems=function(e){var t=this;return Array.from(e.querySelectorAll(".PhotoCarouselItem")).map((function(e){return new oe(e,t)}))},e.prototype.nextWithDelay=function(){var e=this;this.nextPhotoTimerId||(this.nextPhotoTimerId=setTimeout((function(){e.nextPhotoTimerId=null,e.next()}),800))},e.prototype.incrementConfirmedCount=function(e){void 0===e&&(e=1),this.countConfirmedTags+=e},e.prototype.skipActiveItemTags=function(){this.carousel.getActive().skipTags()},e.prototype.showThanksNotification=function(){Object(ie.showDoneBox)(Object(Q.getLang)("photo_recognition_thanks_notification"))},e.prototype.showEndCard=function(){var e,t=this.innerWrapperEl.parentElement;if(t){var o=this.getEndCardData(),i=Object(Q.getLang)("photo_recognition_viewed_photos",this.items.length),n=o.subtitle||"",r=o.button,a=Object(s.se)('\n      <div class="PhotoRecognizeBlockEndCard">\n        <div class="PhotoRecognizeBlockEndCard__close"></div>\n        <div class="PhotoRecognizeBlockEndCard__title">'+i+'</div>\n        <div class="PhotoRecognizeBlockEndCard__subtitle">'+n+"</div>\n      </div>\n    ");if(r){var c=r.title,l=r.action.url,d=Object(s.se)('<a href="'+l+'" class="PhotoRecognizeBlockEndCard__action flat_button secondary">'+c+"</a>");a.appendChild(d)}this.closeEl=a.querySelector(".PhotoRecognizeBlockEndCard__close"),null===(e=this.closeEl)||void 0===e||e.addEventListener("click",this.removeBlock),t.appendChild(a),Object(s.hide)(this.innerWrapperEl),this.sendAnalytic("show_end_card")}},e.prototype.getEndCardData=function(){var e=this.post.getAttribute("data-end-card");return e?Object(F.parseJSON)(e):{}},e.prototype.sendAnalytic=function(e,t){void 0===t&&(t={}),Z(e,this.trackCode,t)},e}();function ae(){return(ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}var ce={sectionUpdateExceptions:["search","notifications","photos_search","mentions","articles","articles_search","likes","recommended","live","topics"],blockHideReason:function e(t,o){if(e.progress)return!1;e.progress=!0;var i="block_"+t,n=ge(i);delete cur.feedEntriesHTML[i],ajax.post("al_feed.php",{act:"a_block_hide_reason",block_id:t,reason:0|o,hash:attr(n,"data-hash"),ref:ce.getModuleRef(),pos:attr(n,"data-pos")},{onDone:function(t){e.progress=!1,t?val(n,t):hide(n)},hideProgress:function(){e.progress=!1}})},blockRestore:function(e){var t="block_"+e,o=ge(t);cur.feedEntriesHTML[t]&&val(t,cur.feedEntriesHTML[t]),ajax.post("al_feed.php",{act:"a_block_restore",block_id:e,hash:attr(o,"data-hash"),ref:ce.getModuleRef(),pos:attr(o,"data-pos")})},blockHide:function(e,t){if(!Object(c.actionsMenuItemLocked)(t)){Object(c.lockActionsMenuItem)(t);var o="block_"+e,i=ge(o),n=geByClass1("ui_actions_menu_wrap",i);ajax.post("al_feed.php",{act:"a_block_hide",block_id:e,hash:attr(i,"data-hash"),ref:ce.getModuleRef(),pos:attr(i,"data-pos")},{onDone:function(e){uiActionsMenu.toggle(n,!1),cur.feedEntriesHTML[o]=val(i),val(i,e)},hideProgress:c.unlockActionsMenuItem.pbind(t)})}},videoRecomsBlockHideCancel:function(){ajax.post("/al_feed.php",{act:"a_video_recom_hide_cancel"}),ce.restorePost("video_recoms")},videoRecomsBlockHideReason:function(e,t){Object(s.re)(geByClass1("feed_rb_video_reason_wrap")),Object(s.show)(geByClass1("feed_rb_video_reason_thankyou")),ajax.post("/al_feed.php",{act:"a_video_recom_hide_reason",reason:t,reason_hash:e})},expandVideosPost:function(e,t){var o=geByClass1("page_post_sized_thumbs",Object(s.domPN)(t)),i=0;each(o.children,(function(){if(!isVisible(this)&&(Object(s.show)(this),++i>5))return!1})),toggle(t,!isVisible(o.children[o.children.length-1]))},closeVideoBlock:function(e){ajax.post("al_feed.php",{act:"a_close_video_block",hash:e});var t=ge("feed_recommends");setStyle(t,{height:getSize(t)[1],opacity:1}),setTimeout((function(){addClass(t,"recoms_hidden")}))},update:function(e){if(!cur.feedUpdateLoading&&!(window.Notifier&&cur.add_queues&&cur.add_queues.length&&(cur.add_queues.forEach((function(e){Notifier.addKey(e,ce.updated)})),"news"!=cur.section)||"feed"!==cur.module||"top"==cur.subsection||inArray(cur.section,ce.sectionUpdateExceptions))){var t=Math.random();if(!("news"!=cur.section&&"comments"!=cur.section&&t>.3||"news"==cur.section&&(e||t>.05))){cur.feedUpdateLoading=!0;var o=ce.getSectionParams(cur.section);extend(o,cur.navParams),ajax.post("al_feed.php?au_"+cur.section,extend(o,{timestamp:cur.timestamp,posted:e?1:"",queue:cur.add_feed_queue?1:0}),{onDone:function(t,o,i){if(cur.feedUpdateLoading=!1,1!=e||o&&-1!=o.indexOf(vk.id+"")){if(!("feed"!==cur.module||t.section!=cur.section||t.timestamp<cur.timestamp||i<cur.timestamp)){Object(h.statlogsValueEvent)("feed_check_update",!!o),t.count+=cur.count;var n,r,a,c,l=cur.rowsCont,d=Object(s.ce)("div"),p=0;if("news"==cur.section){if(c=scrollGetY(),o){for(d.innerHTML=o;d.lastChild;)n=d.lastChild,l.insertBefore(n,l.firstChild),ce.onPostLoaded(n,!0);each(geByClass("ts"+i,l),(function(){p+=this.offsetHeight,Object(u.nodeUpdated)(this),cur.feedUnreadCount++}))}p&&c>100&&scrollToY(c+p,0,!1,!0)}else if(o)for(d.innerHTML=o;n=d.lastChild;)if("DIV"==n.tagName)if("podcasts_recommended_block"!==n.id)if((a=n.firstChild.id.substr(4))&&cur.wallLayer==a)d.removeChild(n);else if(r=ge("post"+a)){var f=function(){if(!Object(s.hasClass)(r.parentNode,"feed_row"))return{v:void 0};var e=ge("replies"+a),t=e.nextSibling,o=0;if(each([].slice.call(geByClass("reply",n,"div")),(function(){ge(this.id)||(addClass(this,"new_reply"),e.appendChild(this),o++)})),o){var i=r.parentNode.offsetHeight,c=geByClass("new_reply",e,"div").length;t&&"replies_open"==t.className||(t=Object(s.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(a),role:"button",tabIndex:0}),e.parentNode.insertBefore(t,e.nextSibling)),t.innerHTML=getLang("wall_x_new_replies_more",Math.min(100,c)),t.newCnt=c;var u=scrollGetY(),h=window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight,p=getXY(t)[1],f=r.parentNode.offsetHeight;i=f-i,inArray(a,cur.feedUnread)||cur.feedUnread.unshift(a),!cur.idleManager.isIdle&&p>u+100&&p<u+h+100?(l.insertBefore(ge("post_ph"+a)||Object(s.ce)("div",{id:"post_ph"+a}),l.firstChild),inArray(a,cur.feedToSort)||cur.feedToSort.push(a)):(Object(s.re)(r.parentNode),l.insertBefore(r.parentNode,l.firstChild),p>u+h+100&&(i=f),i&&scrollToY(scrollGetY()+i,0,!1,!0)),cur.feedUnreadCount+=o}d.removeChild(n)}();if("object"==typeof f)return f.v}else c=scrollGetY(),l.insertBefore(n,l.firstChild),ce.onPostLoaded(n,!0),Object(u.nodeUpdated)(n),p=n.offsetHeight,c>100&&scrollToY(c+p,0,!1,!0);else d.removeChild(n);else d.removeChild(n);ce.applyOptions(t),ce.updateTitle()}}else setTimeout(ce.update.pbind(2),2e3)},onFail:function(){return cur.feedUpdateLoading=!1,!1},showProgress:function(){cur.feedUpdateLoading=!0},hideProgress:function(){cur.feedUpdateLoading=!1}})}}},getNewQKey:function(e){var t={act:"a_get_key",only_update:cur.add_feed_queue?1:0,need_ignore:isArray(cur.ignore_owners)?0:1},o={onDone:function(o,n,s){if(cur.section!=i)return;if(cur.add_feed_queue=s,o)cur.add_queues=o,setTimeout(ce.update.pbind(0),0);else if(!t.only_update){var r=n;return void(cur.timestamp=(r||vkNow()/1e3)-e)}isArray(n)&&(cur.ignore_owners=n)},local:1},i=cur.section;ajax.post("al_feed.php?queue",extend(ce.getSectionParams(cur.section),t),o)},updated:function(e,t){cur.queueTO=cur.queueTO||irand(0,5e3),setTimeout(ce.handleQueueEvent.pbind(e,t),cur.queueTO)},handleQueueEvent:function(e,t){if(("search"==cur.section||"news"==cur.section||!cur.section)&&isArray(cur.add_queues)){var o=!1;if(cur.add_queues.forEach((function(t){t.key===e&&(o=t)})),o){if(t.failed){cur.add_queues=!1,cur.add_feed_queue=null;var i=curNotifier.error_timeout||1;return clearTimeout(cur.lp_error_to),void(cur.lp_error_to=setTimeout(ce.getNewQKey.bind(ce).pbind(i),1e3*i))}if(isArray(t.events)&&t.events.length){o.ts=t.ts,t.key&&(o.key=t.key);var n=scrollGetY(),s=0;each(t.events,(function(){if(isObject(this))return Wall.processQueueEvent(this);s+=ce.pushEvent(this.split("<!>"),n+getSize("page_header_cont")[1])}));var r=scrollGetY();s&&Math.abs(n-r)<100&&(cur.leftMenuDelta=s,scrollToY(r+s,0,!1,!0)),ce.updateTitle(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()}}}},needScrollPost:function(e,t){return e+80>getXY(t)[1]||cur.storyLayer||window.mvcur&&mvcur.mvShown||window.pvcur&&cur.pvShown},pushEvent:function(e,t){var o=e[0],i=e[1],n=e[2],r=ge("post"+n),a=cur.section,c="search"!=a?intval(e.pop()):0,l=0,d=function(e){return intval(getStyle(domByClass(e,"page_block"),"marginTop"))||intval(getStyle(domByClass(Object(s.domNS)(e),"page_block"),"marginTop"))||15};if(!cur.options||o!=cur.options.qversion)return 0;switch((Wall.isArchiveWall()?"archive_post"===i:"reveal_post"===i)&&(i="res_post"),(Wall.isArchiveWall()?"reveal_post"===i:"archive_post"===i)&&(i="del_post"),i){case"new_post":if(r)break;var p=constants.Groups.GROUPS_ADMIN_LEVEL_USER;if(intval(e[11])&&intval(e[11])!=vk.id)return ajax.post("al_feed.php",{act:"a_need_own_reply",oid:intval(e[11])},{onDone:function(o){o&&(e[11]=0,ce.pushEvent(e,t))}}),0;if("search"!=a){var f=n.split("_")[0];e[8]=intval(e[8])>0&&4==(4&c)?"1":"0",f<0&&(p=8&c?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&c?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER)}"search"==a&&Object(h.statlogsValueEvent)("feed_switch",0,"search_update",cur.options.q&&"#"==cur.options.q.charAt(0)?"hashtag":"");var g=cur.rowsCont,v=g.childNodes,m=Wall.getNewPostHTML(e,p,ce.feedPostRepl);if(!m)break;var w,b,y,k,C,E,O=e[12],P="search"!=a&&(window._wf<=0||Object(s.hasClass)(cur.feedEls.wrap,"feed_has_new")||ce.needScrollPost(t,g)),L=cur.storyLayer;L&&(P=!0);var T=!1,j=m;if(P&&(m=Wall.updatePostImages(m)),O){if(cur.ignore_owners.length&&inArray(intval(O),cur.ignore_owners))break;if(b=geByClass1("feed_reposts_wrap"+O,g,"div"))y=geByClass1("feed_reposts_first",b,"div").firstChild,k=geByClass1("feed_reposts_group",b,"div"),C=geByClass1("feed_reposts_more_link",b,"a"),ce.needScrollPost(t,y)&&(l-=y.offsetHeight+d(y)),y.parentNode.replaceChild(w=se(j),y),k.insertBefore(y,k.firstChild),isVisible(k)||val(C,getLang("news_show_X_reposts",k.childNodes.length)),b=b.parentNode,g.firstChild!=b&&g.insertBefore(b,g.firstChild),ce.needScrollPost(t,b)&&(l+=b.offsetHeight+d(b)),b.bits=0;else if((E=geByClass("feed_repost"+O,g,"div"))&&E.length){m=rs(cur.wallTpl.grouped_posts,{place:O,random:irand(1e8,2e8),first:m,other:"",label:getLang("news_show_X_reposts",E.length)});var B=se('<div class="feed_row'+(P?"_unshown":"")+'">'+m+"</div>");Wall.updateAnonNewPost(e,B),g.insertBefore(B,g.firstChild),!P&&ce.needScrollPost(t,B)&&(l+=B.offsetHeight+d(B)),T=!0,b=B.firstChild,w=geByClass1("feed_reposts_first",b,"div"),k=geByClass1("feed_reposts_group",b,"div"),each(clone(E),(function(){ce.needScrollPost(t,this)&&(l-=this.offsetHeight+d(this)),Object(s.re)(this.parentNode),k.appendChild(this.firstChild)}))}else w=se('<div class="feed_row'+(P?"_unshown":"")+'"><div class="feed_repost'+O+'">'+m+"</div></div>"),Wall.updateAnonNewPost(e,w),g.insertBefore(w,g.firstChild),T=!0,!P&&ce.needScrollPost(t,w)&&(l+=w.offsetHeight+d(w))}else w=se('<div class="feed_row'+(P?"_unshown":"")+'">'+m+"</div>"),Wall.updateAnonNewPost(e,w),g.insertBefore(w,g.firstChild),T=!0,!P&&ce.needScrollPost(t,w)&&(l+=w.offsetHeight+d(w));if(0==e[8]){var S=geByClass1("post",w);addClass(S,"closed_comments")}if(cur.deepRepliesActive){var I=geByClass1("post",w);addClass(I,"deep_active")}P&&T&&(cur.newPostsCount=cur.newPostsCount?cur.newPostsCount+1:1,cur.feedEls.newPosts.innerHTML=getLang("news_new_posts",cur.newPostsCount),addClass(cur.feedEls.wrap,"feed_has_new"),1==cur.newPostsCount&&ce.needScrollPost(t,cur.feedEls.newPosts)&&!L&&(l+=getSize(cur.feedEls.newPosts)[1])),AudioUtils.updateQueueReceivedPost(w),cur.feedUnreadCount++,"search"!=a&&Object(u.nodeUpdated)(w),v.length>300?g.removeChild(v[300]):v.length<=1&&removeClass(cur.feedEls.wrap,"feed_is_empty"),Wall.updateMentionsIndex();break;case"new_post_reply":if(r)break;var x=cur.rowsCont,R=x.childNodes,A=Wall.getNewPostHTML(e,!1,ce.feedPostRepl);if(!A)break;var D=se('<div class="feed_row">'+A+"</div>");x.insertBefore(D,x.firstChild),ce.needScrollPost(t,D)&&(l+=D.offsetHeight+d(D)),cur.feedUnreadCount++,R.length>300?x.removeChild(R[300]):R.length<=1&&removeClass(cur.feedEls.wrap,"feed_is_empty");break;case"edit_post":var M,N=ge("wpt"+n);if(!isVisible(r)||!N)break;var H=geByClass1("wall_post_more",N);H&&(H=isVisible(Object(s.domNS)(H))),(M=ce.needScrollPost(t,N))&&(l-=N.offsetHeight);var F=psr(rs(e[3],{poll_hash:cur.wallTpl.poll_hash})),q=ge("post"+n);q&&!isVisible(q.parentNode)&&(F=Wall.updatePostImages(F)),val(N,F),H&&(H=geByClass1("wall_post_more",N))&&H.onclick(),M&&(l+=N.offsetHeight),Object(u.nodeUpdated)(N),window.Wall&&Wall.updatePostAuthorData(n);break;case"edit_reply":var V=e[3],U=ge("wpt"+V);if(!isVisible("post"+V)||!U)break;var G=geByClass1("wall_reply_more",U);G&&(G=isVisible(Object(s.domNS)(G)));var W=psr(e[4]);val(U,W),G&&(G=geByClass1("wall_reply_more",U))&&G.onclick(),Object(u.nodeUpdated)(U);break;case"post_parsed_link":if(!r)break;var z=geByClass1("wall_postlink_preview_btn_disabled",r);if(!z)break;var Y=e[3];if("1"===Y)removeClass(z,"wall_postlink_preview_btn_disabled");else if("0"===Y)Object(s.re)(z);else if(Y){removeClass(z,"wall_postlink_preview_btn_disabled");var X=geByClass1("flat_button",z);X&&(X.setAttribute("href",e[3]),X.removeAttribute("onclick"))}break;case"del_post":if(r){var Q=domClosest("feed_row",r)||domClosest("feed_row_unshown",r)||r;cur.wallMyDeleted[n]||(ce.needScrollPost(t,r)&&(l-=r.offsetHeight+d(r)),revertLastInlineVideo(r),Object(s.re)(Q)),cur.options.offset--,Object(s.hasClass)(cur.feedEls.wrap,"feed_has_new")&&!isVisible(Q)&&(cur.newPostsCount--,cur.newPostsCount?cur.feedEls.newPosts.innerHTML=getLang("news_new_posts",cur.newPostsCount):removeClass(cur.feedEls.wrap,"feed_has_new"))}break;case"res_post":r&&cur.options.offset++;break;case"new_reply":if(!r||cur.wallMyReplied[n]||ge("post"+e[3]))break;if(Object(s.hasClass)(ge("post"+n),"deep_active")){var K=Wall.addNewReply(e);l+=K[0];break}var J=ge("replies"+n),$=ge("replies_wrap"+n),Z=r.offsetHeight,ee=n.split("_")[0]<0?8&c?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&c?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,te=Wall.getNewReplyHTML(e,ee);if(!te)break;var oe,ie=!1,ne=!1;if(isVisible(J)&&isVisible($)&&!isVisible("reply_link"+n)){oe=J.nextSibling;var re=geByClass("new_reply",J,"div").length+1;if(cur.wallMyOpened[n]){oe&&"replies_open"==oe.className&&Object(s.re)(oe),ne=!0;var le=geByClass1("wr_header",J,"a"),de=geByClass("reply",J,"div").length+1,ue=de;le&&(ue=intval(le.getAttribute("offs").split("/")[1])+1),(ue>5||de<ue)&&(le||J.insertBefore(le=Object(s.ce)("a",{className:"wr_header"}),J.firstChild),Wall.updateRepliesHeader(n,le,de,ue))}else te=Wall.updatePostImages(te),ie=se(te),addClass(ie,"new_reply"),oe&&"replies_open"==oe.className||(oe=Object(s.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(n),role:"button",tabIndex:0}),J.parentNode.insertBefore(oe,J.nextSibling)),oe.innerHTML=getLang("wall_x_new_replies_more",Math.min(100,re)),oe.newCnt=re}else Object(s.re)("reply_link"+n),Object(s.show)($,J),ne=!0;n.split("_")[0]==vk.id&&cur.feedUnreadCount++,ie||(ie=se(te)),J.appendChild(ie),ce.needScrollPost(t,ne?ie:oe)&&(l+=r.offsetHeight-Z),ne&&Object(u.nodeUpdated)(ie),Wall.repliesSideSetup(n),Wall.updateMentionsIndex(),Likes.update("wall"+n,{comment_num:e[13]});break;case"del_reply":if(!cur.wallMyDeleted[n]&&r){if(Object(s.hasClass)(gpeByClass("post",r),"deep_active")){var he=Wall.removeDeepReply(e);l+=he[0];break}ce.needScrollPost(t,r)&&(l-=r.offsetHeight);var pe=r.parentNode.id.match(/replies(-?\d+_\d+)/);revertLastInlineVideo(r),Object(s.re)(r),pe&&Wall.repliesSideSetup(pe[1])}break;case"view_post":Likes.update("wall"+n,{views_num:Wall.formatCount(intval(e[3]))});break;case"like_post":case"like_reply":if(!r)break;var fe="like_reply"==i?"wall_reply"+n:n,_e=r&&domByClass(r,"_like_wrap"),ve=r&&domByClass(r,"_share_wrap"),me=Object(_.likeDataReactionsFields)(e);Wall.likeFullUpdate(_e,fe,ae({like_my:_e&&Object(s.hasClass)(_e,"my_like"),like_num:e[3],like_title:!1,share_my:ve&&Object(s.hasClass)(ve,"my_share"),share_num:e[4],share_title:!1},me))}return l},feedPostRepl:function(e,t){e.replies=cur.wallTpl.post_replies;var o={full_id:t[2],item_id:"wall_"+t[2],sec_name:stripHTML(t[3]),date:Wall.getNowRelTime(),del:cur.wallTpl.spam};if("search"==cur.section&&cur.q){var i,n,s,r=e.text||"",a=cur.q.toLowerCase().split(/[\s.,:;!?()]/),c=[],l=(r=r.replace(/<(.|\n)+?>/g,(function(e){return c.push(e),""}))).toLowerCase();for(i=a.length-1;i>=0;i--)if(s=a[i],trim(s))for(n=0;-1!=(n=l.indexOf(s,n));)r.charAt(n-1)!=String.fromCharCode(2)?(r=r.substr(0,n)+""+i+""+r.substr(n+s.length),l=l.substr(0,n)+""+i+""+l.substr(n+s.length)):n+=2;r=(r=r.replace(/\x02(\d+)\x02/g,(function(e,t){return'<span class="highlight">'+a[t]+"</span>"}))).replace(/\x01/g,(function(){return c.shift()||""})),o.text=r,"new_post_reply"==t[1]&&(o.date_postfix=t[7])}return o},reSortItems:function(){cur.feedToSort&&cur.feedToSort.length&&(each(cur.feedToSort,(function(e,t){var o=ge("post_ph"+t),i=ge("post"+t).parentNode;o&&i&&(o.parentNode.insertBefore(i,o),Object(s.re)(o))})),cur.feedToSort=[],scrollToY(0,0))},showNewPosts:function(){removeClass(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0;var e=ge("feed_rows");Wall.loadPostImages(e),each(geByClass("feed_row_unshown",e,"div"),(function(){replaceClass(this,"feed_row_unshown","feed_row")}))},updateTitle:function(){cur.idleManager&&(cur.idleManager.isIdle||(cur.feedUnreadCount=0),setDocumentTitle((cur.feedUnreadCount?"("+cur.feedUnreadCount+") ":"")+cur.feedInitialTitle))},toggleTabsMenuTab:function(e,t){var o=geByClass1("feed_section_"+e,cur.feedEls.rmenu);o&&toggleClass(o,"ui_rmenu_item_hidden",!t)},toggleTabsMenu:function(e,t){var o=ge("feed_add_list_icon");return void 0===t&&(t=!Object(s.hasClass)(o,"shown")),browser.mozilla&&setStyle("page_body",{overflow:t?"visible":""}),uiActionsMenu.toggle(o,t),t&&addEvent(document,"mousedown",(function e(t){ce.toggleTabsMenu(!1,0),removeEvent(document,"mousedown",e)})),e&&cancelEvent(e)},checkTabsFilter:function(e,t){switch(t){case"news":return!1;case"newlist":return ce.addList();default:if(n=t.match(/list(\d+)/))return ce.editList(n[1])}var o,i,n,s=t==cur.section,r=cur.my_feed_types.tabs;o=-1!=(i=indexOf(r,t)),toggleClass(e,"checked",!o),o?(r.splice(i,1),s&&(cur.onSaveTabs=function(e,t){ce.toggleTabsMenu(null,!1),ce.switchSection("news")}.pbind(t,o))):r.push(t),cur.my_feed_types.tabs=r,ce.toggleTabsMenuTab(t,!o||s),uiRightMenu.fixScroller(ge("ui_rmenu_"+cur.section+(cur.list||""))),clearTimeout(cur.saveTabsTO),cur.saveTabsTO=setTimeout(ce.saveTabs,500)},hasSearchParams:function(e){var t=!1;return each(e,(function(e,o){if((!e.indexOf("c[")&&"c[section]"!==e||"q"==e)&&o)return t=!0,!1})),t},getSectionParams:function(e){var t={section:e};switch(e){case"news":case"recommended":case"groups":case"friends":case"videos":case"photos":case"podcasts":void 0===(t.subsection=cur.subsections[e])&&delete t.subsection;break;case"owner":(t.owner=cur.owner)||delete t.section;break;case"source":(t.source=cur.source)||delete t.source;break;case"list":void 0===(t.subsection=cur.subsections["list"+cur.list])&&delete t.subsection,(t.list=cur.list)||delete t.list;break;case"notifications":(t.source=cur.source)||delete t.source;break;case"articles":void 0===(t.subsection=cur.subsections[e])&&delete t.subsection;break;case"search":var o=ge("search_filters_form");if(o){var i=Object(p.serializeForm)(o)||{};for(var n in i)i[n]&&"0"!=i[n]||delete i[n];extend(t,i)}t["c[q]"]=trim(val(cur.feedEls.search));break;case"photos_search":case"breaking_news_search":(t.q=trim(val(cur.feedEls.search)))||delete t.section,(t.sort=intval(cur.search_sort_value))||delete t.sort;break;case"articles_search":(t.q=trim(val(cur.feedEls.search)))||(t.section="articles");break;case"comments":cur.reposts&&(t.reposts=cur.reposts);break;case"mentions":var s=new URLSearchParams(location.search);s.delete("ref"),history.replaceState(null,"","?"+s+location.hash),cur.mentionObj&&cur.mentionObj!=vk.id&&(t.obj=cur.mentionObj)}return t},switchNotifyList:function(e,t){uiRightMenu.go(geByClass1("feed_section_"+e),!1,!1),ce.go(t)},switchSubSection:function(e,t,o){if(t&&checkEvent(t))return!0;var i=cur.section;"list"===cur.section&&(i="list"+cur.list),cur.subsection=cur.subsections[i]=e;var n=ce.getSectionParams(cur.section);n.hash=o,delete cur.feedUpdateLoading,delete cur.isFeedLoading,nav.go(extend(n||{},{0:"feed"})),uiRightMenu.showProgress(cur.feedEls.rmenu)},switchSection:function(e,t,o){if(t&&checkEvent(t))return!0;if(removeClass(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0,"photos_search"==e&&!trim(val(cur.feedEls.search))){if("photos_search"!=cur.section)return!1;e="photos"}"comments"==e&&(cur.reposts=cur.options.reposts=""),Object(h.statlogsValueEvent)("feed_switch",0,e),ce.setSection(e,1);var i=ce.getSectionParams(e||"news");delete cur.feedUpdateLoading,delete cur.isFeedLoading;var n=!o&&extend(i||{},{0:"feed"});return uiRightMenu.go(geByClass1("feed_section_"+e),!1,n),!1},setSection:function(e,t,o){if(t=t||0,cur.prevSection=cur.section,!(e==cur.section&&t<2)&&e){if(uiRightMenu.hideProgress(cur.feedEls.rmenu),cur.feedEls.search&&uiSearch.hideProgress(cur.feedEls.search),t>1){Page.playVkFestBanner&&Page.playVkFestBanner(),toggleClass(cur.feedEls.wrap,"feed_submit_shown",inArray(e,cur.options.feed_types.tabs.concat(["list","likes"]))),toggleClass(cur.feedEls.wrap,"feed_submit_only_shown",~["recommended","search","updates","comments"].indexOf(e));var i=inArray(e,["articles_search","articles","search","photos_search","photos","breaking_news","breaking_news_search"]);toggleClass(cur.feedEls.wrap,"feed_search_shown",i),i&&elfocus(cur.feedEls.search),"search"===e&&o.stories_block_show?addClass(cur.feedEls.wrap,"feed_submit_shown_stories"):removeClass(cur.feedEls.wrap,"feed_submit_shown_stories"),cur.section&&val(cur.feedEls.search,"")}2==t&&window.Stories&&Stories.updateFeedStories(e,o),cur.my_feed_types&&(~indexOf(cur.my_feed_types.optional_tabs,cur.section)&&!~indexOf(cur.my_feed_types.tabs,cur.section)&&ce.toggleTabsMenuTab(cur.section,!1),~indexOf(cur.my_feed_types.optional_tabs,e)&&!~indexOf(cur.my_feed_types.tabs,e)&&ce.toggleTabsMenuTab(e,!0)),cur.section=e,4!=t?(cur.editingHide=("notifications"==e||"replies"==e)&&ce.notifyCheckHideReply,cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()):ce.searchUpdate()}},applyOptions:function(e,t){t=t||0,e.no_left_ads&&(cur.no_left_ads=!0),e.owner&&(cur.owner=e.owner),cur.subsection=e.subsection||"",ce.setSection(e.section,t,e),cur.options||(cur.options={reply_names:{}}),extend(cur.options.reply_names,e.reply_names),delete e.reply_names,extend(cur,e);var o=cur.section;if("list"===cur.section&&(o="list"+e.list),cur.subsections[o]=cur.subsection,e.loc&&2==t&&nav.setLoc(e.loc),e.section&&"news"==e.section&&e.subsection&&"top"==e.subsection&&Object(h.statlogsValueEvent)("feed_switch",0,"top_news",t),void 0!==e.filters){var i=ge("search_filters_minimized"),n=i&&Object(s.hasClass)(i,"ui_rmenu_item_expanded"),a=!!i;val("feed_filters",e.filters),window.searcher&&a&&g.searcher.toggleMinimizedFilters(ge("search_filters_minimized"),n,!0)}if(e.script&&Object(r.evalWithLogging)(e.script),e.htitle&&(cur.feedInitialTitle=document.title=replaceEntities(stripHTML(e.htitle))),void 0!==e.add_feed_queue&&null!==e.add_feed_queue?(cur.add_feed_queue=!1,e.add_feed_queue=!1,ce.getNewQKey(0),!0!==e.add_queue&&(cur.add_queue=e.add_queue)&&setTimeout(ce.update.pbind(0),0)):t&&"search"!=cur.section&&"news"!=cur.section&&cur.section&&(cur.add_feed_queue=!1,e.add_feed_queue=!1),e.add_queues&&(cur.add_queues=e.add_queues,setTimeout(ce.update.pbind(0),0)),e.q){val(cur.feedEls.search,replaceEntities(e.q));var c=e.q;c.length>30&&(c=trim(c.substr(0,30))+"...")}e.last_view&&(cur.options.last_view=e.last_view),void 0!==e.feedback_list&&(cur.options.feedback_list=e.feedback_list),ce.searchUpdate(),"comments"!=cur.section||cur.reposts||toggle("comments_filters",!cur.reposts),isString(cur.all_shown_text)&&val("all_shown",cur.all_shown_text),isString(cur.show_more_text)&&val("show_more_link",cur.show_more_text),cur.empty_text&&val("feed_empty",cur.empty_text),cur.count>=0&&Object(s.re)("feed_error_wrap");var l=!(geByClass1("feed_row",cur.rowsCont,"div")||!1),d=ge("feed_rows_next");if(l?(toggleClass(cur.feedEls.wrap,"feed_is_empty",!isVisible("feed_error_wrap")),hide("all_shown"),toggle("show_more_link",cur.count>0&&!cur.all_shown)):!cur.all_shown||d&&d.firstChild?(hide("all_shown"),Object(s.show)("show_more_link"),removeClass(cur.feedEls.wrap,"feed_is_empty")):(hide("show_more_link"),Object(s.show)("all_shown"),removeClass(cur.feedEls.wrap,"feed_is_empty"),Object(s.re)(d)),e.playlistsData&&(e.playlistsData=JSON.parse(e.playlistsData),cur.pageVideosList=extend(cur.pageVideosList||{},e.playlistsData)),("notifications"==cur.section||"replies"==cur.section)&&cur.notify){var u=ge("feedback_row"+cur.notify);u&&u.onclick&&(setTimeout((function(){u.onclick(),scrollToY(getXY(u)[1],0)}),browser.msie?100:0),delete cur.notify)}cur.feedSection&&cur.feedSection(e.section,e.subsection),e.hot_feature_tooltip&&setTimeout((function(){ce.showHotTooltip(e.hot_feature_tooltip_hash)}),800)},showMore:function(){if(!cur.isFeedLoading){cur.disableAutoMore=!1;var e,t=ge("feed_rows_next");if(t){if(t.firstChild)for(;t.firstChild;)e=t.firstChild,cur.rowsCont!==Object(s.domPN)(t)&&ce.sendInsertBeforeError(),cur.rowsCont.insertBefore(e,t),ce.onPostLoaded(e,!0);Object(s.re)(t)}"live"==cur.section&&(cur.all_shown=!0);var o=ge("show_more_link");if(cur.all_shown&&(hide(o),Object(s.show)("all_shown")),"live"!=cur.section){var i=!1,n=function(e){e.keyCode==KEY.ESC&&(i=!0)};addEvent(document,"keyup",n);var r=ce.getSectionParams(cur.section||"news");extend(r,{offset:cur.offset,from:cur.from,part:1,more:1,last_view:cur.options.last_view}),extend(r,cur.navParams),cur.options.feedback_list&&(r.list=cur.options.feedback_list),nav.objLoc.situational_suggest_id&&(r.situational_suggest_id=nav.objLoc.situational_suggest_id);var a=cur.section;ajax.post("al_feed.php?sm_"+cur.section,r,{onDone:function(e,t){if(removeEvent(document,"keyup",n),a==cur.section)if(i)cur.disableAutoMore=!0;else{if(t){var o,r=Object(s.ce)("div");for(r.innerHTML=t;o=r.firstChild;)o.firstChild&&o.firstChild.id&&!ge(o.firstChild.id)||"feedback_unread_bar"==o.id||Object(s.hasClass)(o,"feed_row_fb_hidden")||Object(s.hasClass)(o,"feed_to_recomm")?(cur.rowsCont.appendChild(o),ce.onPostLoaded(o,!0)):r.removeChild(o)}shortCurrency(),ce.applyOptions(e),setTimeout(ce.scrollCheck,200)}},showProgress:function(){Object(c.lockButton)(o),cur.isFeedLoading=!0},hideProgress:function(){if(Object(c.unlockButton)(o),cur.isFeedLoading=!1,o.seen){var e=Math.ceil((Date.now()-o.seen)/1e3),t=cur.section+(cur.subsection?"_"+cur.subsection:"");Object(h.statlogsValueEvent)("feed_load_more_seen_time",e,t),o.seen=!1}},cache:1})}}},showMoreFriends:function(e,t){checkEvent(t)||(Object(c.lockButton)(e),cur._back.show.push((function(){Object(c.unlockButton)(e)})),nav.go("/friends?act=find"))},showMorePublics:function(e,t){checkEvent(t)||(Object(c.lockButton)(e),cur._back.show.push((function(){Object(c.unlockButton)(e)})),nav.go("/groups?act=catalog&c%5Bcategory%5D=0 "))},getTypesSection:function(){switch(cur.section){case"owner":return cur.owner>0?"person":"group";default:return cur.section}},checkFilter:function(e,t){var o,i=ce.getTypesSection(),n=cur.my_feed_types[i],s=cur.feed_types[i];"notifications"!=i?(!0===n&&(n=clone(s)),-1!=(o=indexOf(n,t))?n.splice(o,1):(n.push(t),n.length==s.length&&(n=!0)),checkbox(e),cur.my_feed_types[i]=n,ce.updateTypesCookie(),ce.setFiltersUpdatePage(),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu)):ce.setNotifyFilter(e,t)},setFilter:function(e,t){var o=ce.getTypesSection(),i=ge(o+"_type_filter"),n=!0;"notifications"!=o&&(each(geByClass("_feed_filter_row",i,"div"),(function(){if(isChecked(this)&&this!=e)return n=!1})),n?(cur.my_feed_types[o]=!0,each(geByClass("_feed_filter_row",i,"div"),(function(){checkbox(this,!0)}))):(each(geByClass("_feed_filter_row",i,"div"),(function(){checkbox(this,!1)})),cur.my_feed_types[o]=[t],checkbox(e,!0)),ce.updateTypesCookie(),ce.setFiltersUpdatePage({force_expand_filters:1}),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu))},setFiltersUpdatePage:function(e){e=e||{};var t=nav.strLoc;if("updates"===cur.section){t.match(/\&filters\_expanded\=1/)||ge("updates_show_all_filters")&&!e.force_expand_filters||(t+="&filters_expanded=1"),t=t.replace(/\&filters\_shown\=([a-z\,]+)/,"");for(var o=geByClass("_feed_filter_row","feed_filters"),i=[],n=0;n<o.length;n++)Object(s.hasClass)(o[n],"hide")||i.push(o[n].id.replace("filter_updates",""));t+="&filters_shown="+i.join(",")}nav.go(t)},setNotifyFilter:function(e,t){checkbox(e),cur.notifyPrefs||(cur.notifyPrefs={}),cur.notifyPrefs[t]=isChecked(e),clearTimeout(cur.saveNotifyPrefsTO),cur.saveNotifyPrefsTO=setTimeout((function(){var e=[];each(cur.notifyPrefs,(function(t,o){e.push((o?"":"-")+t)})),e=e.join(","),ajax.post("/al_feed.php",{act:"a_set_notify_prefs",prefs:e,feed:1,hash:cur.topNotifyHash},{onDone:function(e){addTemplates({top_notify_prefs:e}),toggleClass("top_notify_pref_"+t,"checked",cur.notifyPrefs[t]),cur.notifyPrefs={},window.TopNotifier&&TopNotifier.invalidate(),nav.go(nav.strLoc),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu)}})}),500)},updateTypesCookie:function(){var e=[];each(cur.my_feed_types,(function(t,o){"tabs"!=t&&e.push(!0===o?"*":o.join(","))})),setCookie("remixfeed",e.join("."),365)},toggleFeedTop:function(e,t,o){var i=geByClass1("_ui_toggler",e),n="top";switch(toggleClass(i,"on"),cur.section){case"news":case"recommended":case"groups":case"friends":case"videos":case"photos":case"list":n=Object(s.hasClass)(i,"on")?"top":"recent";break;case"articles":n=Object(s.hasClass)(i,"on")?"suggested":"top";break;case"podcasts":n=Object(s.hasClass)(i,"on")?"recent":"top"}ce.switchSubSection(n,t,o)},switchList:function(e){cur.prevList=cur.list,cur.list=e,ce.setSection("list",1),uiRightMenu.go(geByClass1("feed_section_list"+e),!1,!1),ce.go(ce.getSectionParams(cur.section))},setSearchSort:function(e){cur.search_sort_value=e,ce.submitSearch()},_activateReplyBox:function(e,t,o){(t||{}).cancelBubble=!0;var i=ge("reply_box"+e);if(cur.editing&&cur.editing!=e&&cur.notifyReplyData&&cur.notifyReplyData[cur.editing].disabled&&ce.notifyCheckHideReply(cur.editing,(window.event||{}).target),i&&isVisible(i))ce.notifyCheckHideReply(e,!1);else if(void 0===cur.notifyReplyData&&(cur.notifyReplyData={}),cur.notifyReplyData[e]=o,o.disabled){i?Object(s.show)(i):ge("feedback_row"+e).appendChild(se(rs(cur.options.feedback_dis,{item:e,text:o.disabled}))),setTimeout((function(){cur.editing=e}),0)}else{Object(s.show)(i),Wall.showEditReply(e,t);var n=ge("reply_field"+e);n.setAttribute("placeholder",o.ph),window.Emoji&&Emoji.val(n,o.greet.replace(/ $/,"&nbsp;")),Object(s.data)(n,"send",ce.notifySendReply),removeClass("reply_box"+e,"clear_fix")}},notifyClick:function(e,t,o){var i=ge("feedback_row"+e);Wall.checkPostClick(i,t)&&ce._activateReplyBox(e,t,o)},blindNotifyReply:function(e,t,o){ce._activateReplyBox(e,t,o)},notifySendReply:function(e,t,o){var i=cur.notifyReplyData[e];if(i&&!i.sending){var n,r=ge("reply_field"+e),a=ge("reply_button"+e),l=ge("feedback_row"+e),d=r&&Object(s.data)(r,"composer");if(o.stickerId)n={message:"",attach1_type:"sticker",attach1:o.stickerId};else{if((n=d?Composer.getSendParams(d,ce.notifySendReply.pbind(e)):{message:trim(Emoji.editableVal(r))}).delayed)return;if(!n.attach1_type&&(!n.message||i.greet&&!i.greet.indexOf(n.message)))return void Emoji.editableFocus(r,!1,!0)}extend(n,{act:"post",from:"feedback",item:e},i.params||{});var u=ge("reply_as_group"+e);u&&isVisible(Object(s.domPN)(u))&&(n.from_oid=domData(domClosest("_submit_post_box",u),"from-oid")),i.sending=1,ajax.post("al_wall.php",Wall.fixPostParams(n),{onDone:function(t,o){if(delete i.sending,d?Composer.reset(d):window.Emoji&&Emoji.val(r,""),r.autosize&&r.autosize.update(),ce.notifyHideReply(e),o){var n=geByClass1("_answer_wrap",l);val(n,o),Object(s.show)(n)}else t&&showDoneBox(t)},onFail:function(){delete i.sending},showProgress:c.lockButton.pbind(a),hideProgress:c.unlockButton.pbind(a)})}},notifyCheckHideReply:function(e,t){var o=cur.notifyReplyData&&cur.notifyReplyData[e];if(o&&!o.sending&&isVisible("reply_box"+e)){if(cur.editing=!1,!o.disabled){var i=ge("reply_field"+e),n=trim(window.Emoji?Emoji.editableVal(i):""),s=Wall.hasComposerMedia(i);if(!i||s||n&&!o.greet||o.greet.indexOf(n))return}ce.notifyHideReply(e)}},notifyHideReply:function(e){cur.editing==e&&(cur.editing=!1);var t=ge("feedback_row"+e);removeClass(t,"reply_box_open"),hide("reply_box"+e);var o=cur.replySubmitSettings;o&&o.tt&&o.tt.el&&o.tt.destroy()},notifyPostTooltip:function(e,t,o,i){var n=(o||{}).reply,s="al_wall.php";t.indexOf("topic_comment")?t=t.replace("wall_reply","").replace("wall",""):(s="al_board.php",t=t.replace("topic_comment","")),i=i||{},Object(d.showTooltip)(e,extend({url:s,params:extend({act:"post_tt",post:t,self:1,from:"feedback"},o||{}),slide:15,shift:[!n||n%2?27:329,6],ajaxdt:100,showdt:400,hidedt:800,dir:"auto",className:"rich wall_tt wall_module _feed_notification feed_notification",appendParentCls:"scroll_fix_wrap"},i))},sendInsertBeforeError:function(){ajax.post("al_page.php",{act:"insert_before_error",trace:(new Error).stack,owner_id:cur.oid,module:cur.module})},getModuleRef:function(){var e=cur.module||"feed_other";return"feed"==cur.module&&(e="news"==cur.section?cur.subsection?"feed_news_"+cur.subsection:"feed_news":"podcasts"===cur.section?e+"_"+cur.section+("recent"===cur.subsection?"_my":""):cur.section?e+"_"+cur.section:"feed_other"),e},ignoreItem:function(e,t,o,n,a){var c,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;switch(e){case i.MarketItems:case i.PhotoRecognize:c=ge(e);break;default:c=ge("post"+e)}if(c){var d=c.getAttribute("data-ad"),u=geByClass1("ui_actions_menu_wrap",c),h=ce.getModuleRef();return u&&uiActionsMenu.toggle(u,!1),revertLastInlineVideo(c),t.includes("caption")?cur.feedEntriesHTML[e+"_ignored"]=val(c):cur.feedEntriesHTML[e]=val(c),new Promise((i,u)=>{ajax.post("/al_feed.php?misc",{act:"a_ignore_item",post_raw:e,feed_raw:t,caption_type:n,uids:a,hash:o,ad_data:d,ref:h,session_id:cur.feed_session_id,module:ce.getModuleRef(),position:indexOf(Object(s.domPN)(Object(s.domPN)(c)).children,Object(s.domPN)(c)),reason_id:l},{onDone:function(e,t){ce.destroyPhotoCarouselByPost(c),val(c,e),Object(r.evalWithLogging)(t),i()},onFail:()=>(u(),!0),stat:[jsc("web/privacy.js"),"privacy.css"]})})}},unignoreItem:function(e,t,o,i){var n=ce.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_unignore_item",post_raw:e,feed_raw:t,hash:o,ref:n},{onDone:function(){t.includes("caption")?val("post"+e,cur.feedEntriesHTML[e+"_ignored"]):ce.restorePost(e)},showProgress:i&&c.lockButton.pbind(i),hideProgress:i&&c.unlockButton.pbind(i)})},reportIgnoredItem:function(e,t){ajax.post("al_wall.php",{act:"spam",post:e,hash:t},{onDone:function(t){var o=ge("post"+e),i=o&&geByClass1("feed_post_report",o,"div");val(i,t)}})},ignoreOwner:function(e,t,o,i,n){e&&(cur.feedEntriesHTML[e+"_ignored"]=val("post"+e));var s="list"==cur.section&&cur.list||0,r=ce.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:e,owner_id:t,type:o,hash:i,list:s,ref:r},{onDone:function(o){val("post"+e,o),each(geByClass("post",cur.rowsCont),(function(o,i){var n=this.id.match(/post((-?\d+)_(-?\d+)(_\d+)?)/);n&&n[1]!=e&&(!n[4]&&n[2]==t||n[4]&&n[3]==t)&&(revertLastInlineVideo(this),hide(this.parentNode))}))},showProgress:n&&c.lockButton.pbind(n),hideProgress:n&&c.unlockButton.pbind(n)})},unignoreOwner:function(e,t,o,i){var n="list"==cur.section&&cur.list||0,r=ce.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_unignore_owner",post_raw:e||"",owner_id:t,hash:o,list:n,ref:r},{onDone:function(o){e?val("post"+e,cur.feedEntriesHTML[e+"_ignored"]):val("ignore_row"+t,o),each(geByClass("post",cur.rowsCont),(function(e,o){var i=this.id.match(/post((-?\d+)_(-?\d+)(_\d+)?)/);i&&(!i[4]&&i[2]==t||i[4]&&i[3]==t)&&Object(s.show)(this.parentNode)}))},showProgress:i&&c.lockButton.pbind(i),hideProgress:i&&c.unlockButton.pbind(i)})},ignoreGroupWall:function(e,t,o,i){e&&(cur.feedEntriesHTML[e+"_ignored"]=val("post"+e));var n=ce.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:e,owner_id:t,ignore_type:"group_wall",hash:o,ref:n},{onDone:function(t){val("post"+e,t)},showProgress:i&&c.lockButton.pbind(i),hideProgress:i&&c.unlockButton.pbind(i)})},unignoreGroupWall:function(e,t,o,i){var n=ce.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_unignore_owner",post_raw:e||"",owner_id:t,ignore_type:"group_wall",hash:o,ref:n},{onDone:function(o){e?val("post"+e,cur.feedEntriesHTML[e+"_ignored"]):val("ignore_row"+t,o)},showProgress:i&&c.lockButton.pbind(i),hideProgress:i&&c.unlockButton.pbind(i)})},ignoreLiveOwner:function(e,t,o,i){var n=ge("post"+e),s=geByClass1("ui_actions_menu_wrap",n);s&&uiActionsMenu.toggle(s,!1),revertLastInlineVideo(n),cur.feedEntriesHTML[e+"_ignored"]=val("post"+e),ajax.post("al_feed.php?act=a_ignore_live_owner",{post_raw:e,owner_id:t,hash:o},{onDone:function(t){val("post"+e,t)},showProgress:i&&c.lockButton.pbind(i),hideProgress:i&&c.unlockButton.pbind(i)})},unignoreLiveOwner:function(e,t,o,i){ajax.post("al_feed.php?act=a_unignore_live_owner",{post_raw:e,owner_id:t,hash:o},{onDone:function(t){val("post"+e,cur.feedEntriesHTML[e+"_ignored"])},showProgress:i&&c.lockButton.pbind(i),hideProgress:i&&c.unlockButton.pbind(i)})},unsubscribe:function(e,t,o){triggerEvent(ge("post_delete"+e),"mouseout"),cur.feedEntriesHTML[e]=ge("post"+e).innerHTML;var i=e.match(/(\-?\d+)_(photo|video|topic|note|market|)(\d+)/);i&&ajax.post("al_feed.php",{act:"unsubscribe",type:{"":24,photo:21,video:22,topic:20,note:23,market:25}[i[2]],owner_id:i[1],place_id:i[3],hash:t,feed:1},{onDone:function(t){ge("post"+e).innerHTML=t.replace("%post_raw%",e)},showProgress:o&&c.lockButton.pbind(o),hideProgress:o&&c.unlockButton.pbind(o)})},subscribe:function(e,t,o){var i=e.match(/(\-?\d+)_(photo|video|topic|note|market|)(\d+)/);i&&ajax.post("al_feed.php",{act:"subscribe",type:{"":24,photo:21,video:22,topic:20,note:23,market:25}[i[2]],owner_id:i[1],place_id:i[3],hash:t,feed:1},{onDone:ce.restorePost.pbind(e),showProgress:o&&c.lockButton.pbind(o),hideProgress:o&&c.unlockButton.pbind(o)})},restorePost:function(e){var t;switch(e){case i.MarketItems:case i.PhotoRecognize:t=ge(e);break;default:t=ge("post"+e)}if(t){t.innerHTML=cur.feedEntriesHTML[e],this.initPhotoCarouselInPost(t);var o=geByClass1("input_back",t,"div"),n=geByTag1("textarea",t);n&&(n.placeholder=o.innerHTML,o.parentNode.removeChild(o),Object(a.placeholderSetup)(n))}},toggleReposts:function(e,t,o,i){if(checkEvent(i))return!0;var n=ge("feed_reposts_more"+t+"_"+o),r=ge("feed_reposts"+t+"_"+o),a=0,c=scrollGetY(),l=isVisible(r);if(r)return l?a-=r.offsetHeight+intval(getStyle(e,"marginTop")):(Object(s.domPN)(Object(s.domPN)(r))||{}).bits=0,toggle(r,!l),val(n,l?getLang("news_show_X_reposts",r.childNodes.length):getLang("news_hide_reposts")),a&&scrollToY(c+a+getSize("page_header")[1],0),!1;n&&Object(s.re)(n.parentNode.parentNode)},editHidden:function(){return showTabbedBox("al_settings.php",{act:"a_edit_owners_list",list:"feed",height:lastWindowHeight},{stat:["ui_controls.js","ui_controls.css",jsc("web/indexer.js")]}),cur.onOListSave=ce.onHiddenSave,!1},onHiddenSave:function(e,t,o,i){var n=curBox(),s={act:"a_ignore_olist",no_reposts:ge("feed_list_reposts")&&!isChecked("feed_list_reposts")?1:0,hash:i.hash};return e.length<t.length?s.White=e.join(","):s.Black=t.join(","),ajax.post("al_feed.php",s,{onDone:function(e,t){n.hide(),ce.switchSection("photos"==cur.section?"photos":"news")},showProgress:c.lockButton.pbind(n.btns.ok[0]),hideProgress:c.unlockButton.pbind(n.btns.ok[0])}),!1},addList:function(){return ce.editList(-1)},editList:function(e){return ce.toggleTabsMenu(!1,0),showTabbedBox("al_settings.php",{act:"a_edit_owners_list",list:"feed",list_id:e,height:lastWindowHeight},{stat:["ui_controls.js","ui_controls.css",jsc("web/indexer.js")],onFail:function(e){return setTimeout(Object(l.showFastBox)({title:getLang("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e,getLang("global_close")).hide,4500),!0}}),cur.onOListSave=ce.onListSave.pbind(e),!1},onListSave:function(e,t,o,i,n){var r=val("feed_list_name");if(!trim(r))return Object(c.notaBene)("feed_list_name"),!1;if(!t.length)return!1;var a=curBox();return ajax.post("al_feed.php",{act:"a_save_list",hash:cur.tabs_hash,White:t.join(","),title:r,list_id:e,no_reposts:ge("feed_list_reposts")&&!isChecked("feed_list_reposts")?1:0},{onDone:function(t){var o=geByClass1("feed_section_list"+e,cur.feedEls.rmenu),i=geByClass1("feed_filter_list"+e,cur.feedEls.rmenu);val(o,clean(r)),val(geByClass1("ui_actions_menu_item_label",i),clean(r)),a.hide(),e>0?ce.switchList(e):nav.go({0:"feed",section:"list",list:t},null,{nocur:!0})},onFail:function(e){return val("feed_list_error",e),Object(s.show)("feed_list_error_wrap"),!0},showProgress:c.lockButton.pbind(a.btns.ok[0]),hideProgress:c.unlockButton.pbind(a.btns.ok[0])}),!1},deleteList:function(e,t,o,i){if(i&&cancelEvent(i),e<=0)return!1;if(o){var n=curBox();ajax.post("al_feed.php",extend({act:"a_delete_list",list_id:e,hash:cur.tabs_hash}),{onDone:function(){Object(s.re)(geByClass1("feed_section_list"+e,cur.feedEls.rmenu)),Object(s.re)(geByClass1("feed_filter_list"+e,cur.feedEls.rmenu)),boxQueue.hideAll(),"list"==cur.section&&cur.list==e&&ce.switchSection("news")},showProgress:c.lockButton.pbind(n.btns.ok[0]),hideProgress:c.unlockButton.pbind(n.btns.ok[0])})}else{ce.toggleTabsMenu(!1,0);var r=Object(l.showFastBox)({title:getLang("news_delete_list_sure_title"),bodyStyle:"padding: 20px; line-height: 160%;"},getLang("news_delete_list_sure").replace("{list}",t),getLang("global_delete"),(function(){ce.deleteList(e,t,!0)}),getLang("global_cancel"),(function(){r.hide()}))}},saveTabs:function(){ajax.post("al_feed.php",{act:"a_save_tabs",hash:cur.tabs_hash,tabs:cur.my_feed_types.tabs.join(",")},{hideProgress:function(){Object(m.isFunction)(cur.onSaveTabs)&&cur.onSaveTabs(),cur.onSaveTabs=null}})},statsShow:function(e,t){return showWiki({w:"stats"+(cur.source||"")},!1,e)},editLiveBlacklist:function(e){cancelEvent(e),showBox("al_video.php?act=live_blacklist_box",{},{onDone:function(e,t){w.default.init(e,t)},stat:["videoview.js","videoview.css",jsc("web/indexer.js")]})},scrollCheck:Object(v.debounce)((function(e){if("scroll"==(e=e||{}).type||cur.idleManager&&!cur.idleManager.isIdle){var t,o,i,r,a,l,d=window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight,u=scrollGetY(),p=0,_=[];if(cur.isFeedLoading||cur.disableAutoMore||(r=ge("show_more_link"),isVisible(r)&&u+d+1e3>r.offsetTop&&ce.showMore()),Object(s.domPN)(cur.topRow)==cur.rowsCont&&"feed_rows_next"!=(cur.topRow||{}).id||(cur.topRow=domFC(cur.rowsCont)),vk.id&&cur.topRow&&"feed_rows_next"!=cur.topRow.id&&(!((window.curNotifier||{}).idle_manager||{}).is_idle||"init"==e.type)){var g=[];for(r=domPS(cur.topRow);r;r=domPS(r))cur.topRow.offsetTop>u&&(cur.topRow=r),r.unseen||(r.unseen=!0,g.push(b(r)));for(Page.postsUnseen(g),r=cur.topRow;r&&!((t=p||r.offsetTop)>=u+d);r=a)if("feed_rows_next"==((a=Object(s.domNS)(r))||{}).id&&(a=null),(p=a?a.offsetTop:t+r.offsetHeight)<u&&a&&(cur.topRow=a),LongView&&LongView.register(r,"feed"),T(r),!((l=r.bits||0)>=3)&&(cur.feedSeenPostHeight>0?(cur.feedPostHeaderHeight=cur.feedPostHeaderHeight||Object(s.getH)(geByClass1("post_header",r)),i=(o=t+cur.feedPostHeaderHeight)+cur.feedSeenPostHeight,r.postBottom||(r.postBottom=o+Object(s.getH)(geByClass1("wall_text",r))),l|=(o>=u&&o<u+d?1:0)|((i=Math.min(i,r.postBottom))>=u&&i<u+d?2:0)):l|=(t>=u&&t<u+d?1:0)|(p>=u&&p<u+d?2:0),l&&(r.bits=l,3==l))){var v=b(r);if(k(r)||y(r)?Wall.triggerAdStat(domFC(r),"impression"):_.push(v),Object(s.hasClass)(r,"feed_to_recomm"))Object(h.statlogsValueEvent)("promo_button_view_blocks",v.index,v.module);else if(geByClass1("feed_friends_recomm",r))!function(){var e=geByClass1("ui_gallery",r),t=domData(e,"from"),o=domData(e,"code")||"";Object(f.friendsRecommLogSave)(["view_block",t,v.index,vkNow(),v.module,o],!0);var i=Object(n.uiGetGallery)(e);i&&i.getVisibleItems().forEach((function(e){Object(f.onViewFriendRecomm)(e[0],e[1],t)})),e.visible=!0}();else if(geByClass1("feed_groups_recomm",r)){var m,w=geByClass1("ui_gallery",r),C=domData(w,"code")||"";null===(m=window.RecommendedGroups)||void 0===m||m.viewBlock(C);var E=Object(n.uiGetGallery)(w);E&&E.getVisibleItems().forEach((function(e){var t;null===(t=window.RecommendedGroups)||void 0===t||t.onViewGroup(e[0])})),w.visible=!0}}_=_.concat(L(u,d)),LongView&&LongView.onScroll(u,d),Page.postsSeen(_);var O=ge("show_more_link"),P=O.offsetTop;if(!O.seen&&P>=u&&P<u+d){O.seen=Date.now();var j=cur.section+(cur.subsection?"_"+cur.subsection:"");Object(h.statlogsValueEvent)("feed_load_more_seen",Object(c.isButtonLocked)(O),j)}}}}),20),searchUpdate:function(){var e;cur.feedEls.search&&getLang("news_search")&&(e=cur.section.indexOf("photos")?cur.section.indexOf("articles")?getLang("news_search"):getLang("news_articles_search"):getLang("news_photo_search"),cur.feedEls.search.setAttribute("placeholder",clean(unclean(e))),placeholderInit(cur.feedEls.search,{reload:!0}))},go:function(e,t,o){if(e=e||{},cur._back_local){var i=cur._back_local;i.back?showBackLink(i.back[0],i.back[1],i.back[2]):showBackLink(!1),cur._back_local=!1}if(cur.feedReq)try{cur.feedReq.abort()}catch(e){debugLog(e)}cur.feedReqObj=null;var n=1,a=function(){cur.isFeedLoading=!1};(browser.msie||o)&&(n=!1,a=cur.onFrameBlocksDone),cur.wasScroll=!!o&&scrollGetY();var c=window.event&&window.event.target;if(c&&"search"===e.section&&!e._post){var l=nav.getPostParams(c);if(l.post_id&&l.post_click_type){function d(t,o){t&&!e[o]&&(e[o]=t)}d(l.post_id,"_post"),d(l.post_click_type,"_post_click_type"),d(l.post_click_url,"_post_click_url"),d(l.post_click_mention_id,"_post_click_mention_id"),d(l.post_click_cc_key,"_post_click_cc_key"),d(l.ad_data,"_post_ad_data"),d(l.ad_block_unique_id,"_post_ad_block_unique_id")}}var u=cur.feedReqObj={},p={},f=0,_=()=>{if(cur.feedReqObj&&cur.feedReqObj===u&&!(++f>500)){var e=!0,t={};each(p,(function(o){var i=ge(o);if(i&&Object(s.hasClass)(i,"feed_row"))return i.firstChild?void ce.onPostLoaded(i,!0):(t[o]=!0,void(e=!1))})),e||(p=t,setTimeout(_,100))}},g=+new Date;cur.feedReq=ajax.post("al_feed.php",extend(e,{part:1}),{onDone:function(o,i,a,c,l){if(revertLastInlineVideo(),removeClass(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0,window.tooltips&&tooltips.destroyAll(ge("feed_rows")),boxQueue.hideAll(),layers.fullhide&&!cur.storyLayer&&layers.fullhide(!0),n&&ajax._framenext(),window.wall&&Wall.cancelEdit(),boxQueue.hideAll(),t?t(i||""):val(cur.rowsCont,i||""),ce.applyOptions(o,2),!e.norecom&&"notifications"!==e.section){val("feed_recommends",o.recommends||""),toggle("feed_recommends",!!o.recommends);var d="/al_feed.php#"+AjaxConvert.toQueryString({act:"recom"});ajaxCache[d]&&delete ajaxCache[d],cur.recomPreload=!1,toggleClass(cur.feedEls.wrap,"feed_asc_shown",geByClass1("feed_asc_block","feed_recommends"))}var u;if(a&&Object(r.evalWithLogging)(a),checkPageBlocks(),scrollToTop(0),shortCurrency(),cur.feedEls.wall)switch(u="clear_fix",cur.section){case"updates":u+=" page_block feed_updates";break;case"photos_search":u+=" page_block feed_found_photos";break;case"notifications":u+=" page_block feed_notifications";break;case"coronavirus":case"stayhome":u+=" feed_wall--with-header"}if(ge("feed_wall").className=u,toggle("feed_recommends",inArray(cur.section,["news","recommended","videos"])),val("feed_app_widget",c||""),toggle("feed_app_widget",c),c&&l&&Object(r.evalWithLogging)(l),cur.rowsCont&&cur.rowsCont.children&&(each(cur.rowsCont.children,(function(){var e=this;Object(s.hasClass)(e,"feed_row")&&(!e.id||e.firstChild?ce.onPostLoaded(e,!0):p[e.id]=!0)})),isEmpty(p)||setTimeout(_,10)),cur.q){var f="photos_search"===cur.section?h.servicePhotos:h.serviceNews,v=+new Date-g;Object(h.saveSearchAttemptStats)(f,0,cur.count,val(cur.feedEls.search),0,0,v)}setTimeout(ce.scrollCheck,200)},onFail:function(){return!1},showProgress:function(){cur.isFeedLoading=!0},frame:n,ads:1,hideProgress:a})},onFeedSearch:function(e,t,o,i){t||Object(h.removeSearchPositionTracker)("photos");var n,s,r=i||cur.section;if(r.indexOf("photos")?r.indexOf("breaking_news")?r.indexOf("articles")?(n="search",s="news"):(n="articles_search",s="articles"):(n="breaking_news_search",s="breaking_news"):(n="photos_search",s="photos"),"search"==n||ce.hasSearchParams(ce.getSectionParams(n))){n!=cur.section&&ce.setSection(n,1);var a=ce.getSectionParams(n);cur.disableSort&&(a.disable_sort=1),ce.go(a),window.searcher&&g.searcher.highlightHotHashtag(t||val(e))}else ce.go(ce.getSectionParams(s));uiSearch.onChanged(e),uiSearch.showProgress(e)},onSearchChange:function(){return setTimeout(ce.onFeedSearch.pbind(cur.feedEls.search),0),!1},init:function(e){var t,o,i,n;setTimeout((function(){each(geByTag("textarea",cur.rowsCont),(function(){Object(a.placeholderSetup)(this)})),cur.q&&Object(h.saveSearchAttemptStats)("photos_search"===cur.section?h.servicePhotos:h.serviceNews,0,cur.count,val(cur.feedEls.search))}),200),extend(cur,{oid:e.user_id,postTo:e.user_id,phCache:{},phShown:{},subsections:{},feed_session_id:e.feed_session_id||"na",module:"feed",isFeedLoading:!1,customSearchChange:ce.onSearchChange,navParams:e.nav_params||{},wallPostCb:function(){"news"==cur.section?setTimeout(ce.update.pbind(1),1e3):setTimeout(ce.switchSection.pbind("news"),1e3)},idleManager:(n={isIdle:!1,onIdle:null,onUnIdle:null,stop:function(){removeEvent(document,"mousemove keydown",t),removeEvent(window,"focus blur",i)},start:function(){browser.mobile||(t=function(){cur.idleManager&&n.isIdle&&(n.isIdle=!1,n.onUnIdle&&n.onUnIdle())},o=function(){cur.idleManager&&(n.isIdle=!0,n.onIdle&&n.onIdle())},i=function(e){"focus"==e.type?t():o()},addEvent(window,"focus blur",i))}},n),currentModule:function(){return"videos"==cur.section?"feed_videos":cur.module},onFrameBlocksDone:function(){cur.isFeedLoading=!1,(0===cur.wasScroll||cur.wasScroll>0||!1===cur.wasScroll&&"search"==cur.section&&cur.q&&"#"==cur.q.substr(0,1))&&(cur.wasScroll=!1)},feedEntriesHTML:{},feedUnreadCount:0,feedInitialTitle:"",feedUnread:[],feedToSort:[],feedEls:{wrap:ge("main_feed"),wall:ge("feed_wall"),search:ge("search_query"),rmenu:ge("feed_rmenu"),newPosts:ge("feed_new_posts")}}),cur.nav.push((function(e,t,o,i){if(void 0===e[0]){var n=clone(o);if(delete n[0],void 0===e.section||inArray(cur.section,["notifications","replies"])==inArray(e.section,["notifications","replies"])){if("notifications"==cur.section)return ce.switchNotifyList(o.list||"all",extend(n,i.params||{})),!1;if(e.list)return ce.switchList(e.list),!1;if(void 0!==e.section&&ce.switchSection(e.section||"news",!1,!0),e.notify)return!1;if(e.q)return val(cur.feedEls.search,e.q),ce.onFeedSearch(cur.feedEls.search),!1;if(delete e.subsection,isEmpty(e)){var s=geByClass1("feed_section_"+(t.section||"news")+(t.list||""));s&&uiRightMenu.go(s,!1,!1)}return cur.likesTabTT&&cur.likesTabTT.destroy(),ce.go(extend(n,i.params||{})),!1}}})),cur.idleManager.onUnIdle=ce.updateTitle,cur.idleManager.onIdle=ce.reSortItems,cur.options=cur.options||{},extend(cur.options,e),ce.applyOptions(e,3),cur.rowsCont=e.wallCont=ge("feed_rows"),Wall.init(e),cur.rowsCont&&cur.rowsCont.children&&each(cur.rowsCont.children,(function(){Object(s.hasClass)(this,"feed_row")&&this.firstChild&&ce.onPostLoaded(this,!0)})),cur._back={text:getLang("news_return_to_news"),show:[ce.startEvents],hide:[function(){clearInterval(cur.updateInt),removeEvent(window,"scroll",ce.scrollCheck),removeEvent(window,"resize",ce.scrollCheck),cur.idleManager.stop(),clearTimeout(cur.lp_error_to)}],loc:!1},ce.startEvents(),Object(f.friendsRecommLogSend)(!0),setTimeout((function(){ce.scrollCheck({type:"init"})}),200)},startEvents:function(){cur.idleManager.start(),cur.updateInt=setInterval((function(){ce.update(0)}),2e4),addEvent(window,"scroll",ce.scrollCheck),addEvent(window,"resize",ce.scrollCheck)},mentionClick:function(e,t){var o=e,i=((e.getAttribute("mention")||"").match(/^bp(-?\d+_\d+)$/)||{})[1];if(!i)return nav.go(e,t);for(i=i.split("_");e;e=e.parentNode){var n=(e.id||"").match(/^replies(-?\d+_topic\d+)$/);if(n){if(n[1].split("_")[0]==i[0])return Wall.showReply(o,n[1],i[0]+"topic_"+i[1],t);break}}return nav.go(e,t)},toggleCustomFeedTab:function(e,t){return Object(s.hasClass)(e,"feed_tab_link_hidden")?(removeClass(e,"feed_tab_link_hidden"),setCookie("remixcustom_feed_added",t)):Object(c.lockButton)(e),ce.checkTabsFilter(geByClass1("_feed_custom_"+t),t)},recomPreload:function(){cur.recomPreload||(cur.recomPreload=!0,ajax.post("/al_feed.php",{act:"recom",section:cur.section},{cache:1}))},recomMore:function(e){if(!1===checkEvent(e)){var t=ge("feed_recom_rows"),o=ge("feed_recom_more");if(t.childNodes.length>2){for(;t.childNodes.length>2;)t.removeChild(t.lastChild);return scrollToY(0,0),hide(o.firstChild.nextSibling),Object(s.show)(o.firstChild),cancelEvent(e)}return ajax.post("/al_feed.php",{act:"recom",section:cur.section},{cache:1,onDone:function(e){hide(o.firstChild),Object(s.show)(o.firstChild.nextSibling);for(var t,i=Object(s.ce)("div",{innerHTML:e}),n=ge("feed_recom_rows");t=i.firstChild;)ge(t.id)?Object(s.re)(t):n.appendChild(t);n.childNodes.length%2&&Object(s.re)(n.lastChild)},showProgress:function(){hide(o.firstChild),Object(s.show)(o.lastChild)},hideProgress:function(){Object(s.show)(o.firstChild),hide(o.lastChild)}}),cancelEvent(e)}},recomSubscribe:function(e,t,o){var i,n,r=o?t:domPS(t),a=o?Object(s.domNS)(t):t;o?(i="/al_feed.php",n={act:"subscr",oid:e,from:nav.objLoc.section,hash:val("feed_recom_hash")}):(i="/al_fans.php",n={act:"unsub",oid:e,hash:val("feed_recom_hash"),no_response:1}),ajax.post(i,n,{onDone:function(){toggle(r,!o),toggle(a,!!o),"recommended"!=nav.objLoc.section&&nav.go(nav.objLoc,!1,{params:{norecom:1}})},showProgress:c.lockButton.pbind(t),hideProgress:c.unlockButton.pbind(t)})},clickBlogReminder:function(e,t,o,i,n,s){if(ajax.post("blog.php",{act:"click_reminder",hash:i,nid:t,accept:1,target:s},{onDone:function(){}}),"_blank"!==attr(e,"target"))return cancelEvent(n),nav.go(o)},hideBlogReminder:function(e,t,o,i){o&&cancelEvent(o),Object(s.re)("feed_blog_reminder"),ajax.post("blog.php",{act:"hide_reminder",hash:e,nid:t,accept:0,target:i},{onDone:function(){}})},preloadVideos:function(e){function t(e){var t=new XMLHttpRequest;t.open("GET",e),t.send()}e&&cur.videoAutoplayScrollHandler&&(cur.videoAutoplayPreloaded=cur.videoAutoplayPreloaded||{},each(e,(function(e,o){t(o.index_url),t(o.index_url.replace(/index-(.+).m3u8/,"seg-1-$1.ts")),cur.videoAutoplayPreloaded[o.video]=o.quality})))},expandJoinedGroups:function(e,t){return cancelEvent(t),Object(s.show)(geByClass1("feed_groups_hidden_list",e.parentNode)),Object(s.re)(e),!1},showAllFilters:function(e){Object(s.re)(e);for(var t=geByClass("hide",e.parentNode),o=0;o<t.length;o++)removeClass(t[o],"hide")},toggleSubscription:function(e,t,o,i,n){var r=domClosest("_ui_menu_wrap",e);r&&uiActionsMenu.toggle(r,!Object(s.hasClass)(r,"shown")),Page.toggleSubscription(e,t,o,i,n,(function(e,t){geByClass("post",cur.rowsCont).forEach((function(o){var n=o.id.split("_"),s=+n[n.length-2].replace("post","");if(i===s){var r=geByClass1("page_action_subscribe",o);val(r,e),domData(r,"act",t)}}))}))},logBlockInteraction:function(e,t,o){var i=indexOf(Object(s.domPN)(e).children,e);Object(h.statlogsValueEvent)("block_interaction",i,t,o)},showHotTooltip:function(e){var t=geByClass1("hot");t&&(cur.hotFeatureTT=new ElementTooltip(t,{content:'<div class="feature_tooltip__close" onclick="cur.hotFeatureTT.hide();"></div>'+getLang("wall_hot_feature_text"),forceSide:"left",cls:"feature_intro_tt feature_info_tooltip hot_feature_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendToParent:!0,offset:[15,0],onHide:function(){ajax.post("al_index.php",{act:"hide_feature_tt",hash:e,type:"hot_web"})}}),cur.hotFeatureTT.show())},onPostLoaded:function(e,t){var o=geByClass1("friends_recomm_gallery",e);o&&Object(f.friendsRecommInit)(o,{checkViewItem:function(){return o.visible},onDestroy:function(){Object(s.re)(e)}}),Wall.onPostLoaded(e,t),this.initPrettyCardGallery(e),t&&!Object(s.hasClass)(e,"_post")&&this.initPhotoCarouselInPost(geByClass1("_post",e))},openPostSuggest:function(e,t,o){if(t&&null!=t.type)switch(t.type){case 1:var i=t.postData,n=t.notHideByClick,s=ge("post_field");return void((s?trim(s.innerHTML).replace("<br>",""):"")||cur.wallAddMedia&&cur.wallAddMedia.attachCount()?Object(l.showFastBox)({title:getLang("news_suggest_alert_title"),dark:1},getLang("news_suggest_alert_text"),getLang("global_yes"),(function(){curBox().hide(),r(i,n)}),getLang("global_cancel")):r(i,n));case 4:return window.open(t.link),void ce.suggestionEvent(e,"open",o,t.notHideByClick)}function r(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(),cur.options&&(cur.options.situational_suggest_id=e),t[0]=t[0].replace(/<br>/g,"\n");var n=cur.editing;delete cur.editing,Wall.setDraft(t),ce.suggestionEvent(e,"open",o,i),cur.editing=n}},suggestionEvent:(e,t,o,i)=>(ajax.post("al_feed.php",{act:"suggestion_event",suggest_id:e,event_type:t,not_hide_by_click:intval(i)}),i||Object(s.re)(geByClass1("_post_suggest")),cancelEvent(o)),closePostSuggest(e,t,o){ce.suggestionEvent(e,t,o,!1)},hideRightBlock:function(e,t,o){var i=domCA(e,".page_block");return Object(s.re)(i),ajax.post("al_feed.php",{act:"a_hide_right_block",block_type:t,app_id:e.dataset.app_id||0,hash:o}),!1},initPrettyCardGallery:function(e){if(!geByClass1("pretty-cards",e))return!1;window.PrettyCardGallery&&new PrettyCardGallery(e)},initPhotoCarouselInPost(e){if(e){var t=function(e,t){var o=e.querySelector(".PhotoCarousel");if(o)try{return o.classList.contains("PhotoCarousel--recognize")?new re(e):new W(e,{sendAnalytic:t})}catch(e){console.error(e),Object(z.logError)(e)}}(e,ce.sendPhotoCarouselEvent.bind(ce));Object(s.data)(e,"photo_carousel",t),window.cur.destroy.push(()=>{Object(s.removeData)(e,"photo_carousel")})}},destroyPhotoCarouselByPost(e){var t=Object(s.data)(e,"photo_carousel");t&&t.destroy()},sendPhotoCarouselEvent(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t){var i=t.querySelector(".post_img"),n=i&&i.getAttribute("data-post-id");if(n){var s,r,a=n.match(/(-?\d+)_p(\d+)/);if(a&&a[1]&&a[2]){s=a[1],r=a[2];var c=t.getAttribute("data-photo-raw-id"),l=t.getAttribute("data-pseudopost-type"),d=t.getAttribute("data-post-creation-timestamp");if(!c&&"photo_group"===l&&o){var u=o.target;if(u&&u.href){var p=u.href.match(/\/photo(-?\d+_\d+)/);c=p&&p[1]}}var f={event_type:e,content_type:l,post_owner_id:s,post_id:r,photo_raw_id:c,timestamp:d,ref:ce.getModuleRef()};Object(h.statlogsValueEvent)("feed_new_carousel_stat",f)}}}},disablePhotoRecognizeBlock(e){var t=document.getElementById(""+i.PhotoRecognize);t&&(cur.feedEntriesHTML[i.PhotoRecognize+"_ignored"]=val(t),ajax.post("al_feed.php",{act:"disable_recognize_block",hash:e},{onDone:e=>{val(t,e)}}))},enablePhotoRecognizeBlock(e){var t=document.getElementById(""+i.PhotoRecognize);t&&ajax.post("al_feed.php",{act:"enable_recognize_block",hash:e},{onDone:()=>{val(t,cur.feedEntriesHTML[i.PhotoRecognize+"_ignored"])}})},showMarketItem(e,t,o,i){A.showItem(e,t,o,i)},showAllMarketItems(e,t,o){A.showAll(e,t,o)},logMarketItemsBlockClick(e,t,o,i){A.logClick(e,t,o,i)}};window.feed=ce,window.Feed=ce;try{stManager.done(jsc("web/feed.js"))}catch(e){}},fBgk:function(e,t,o){"use strict";o.r(t),o.d(t,"getDefaultReaction",(function(){return n})),o.d(t,"getDefaultReactionTitle",(function(){return s})),o.d(t,"prepareReactionMenuSet",(function(){return a})),o.d(t,"isValidReactionId",(function(){return c})),o.d(t,"isValidReactionIdState",(function(){return l})),o.d(t,"parseReactionId",(function(){return d})),o.d(t,"validateReactionSetPayloaditems",(function(){return u}));var i=o("/bCM"),n=function(e){return e.itemsById[i.REACTION_ID_DEFAULT]},s=function(e){var t;return null===(t=n(e))||void 0===t?void 0:t.title},r=function(e,t){return 0===e.length?"":(o=e,i=function(e){return Math.pow(t.width-e.width,2)+Math.pow(t.height-e.height,2)},n=!1,void 0===n&&(n=!0),o.reduce((function(e,t){var o=i(t),s=i(e);return s===o?n?e:t:s<o?e:t}))).url;var o,i,n},a=function(e,t,o){var i=o.imageMenuSize,n=o.imagePreviewSize,s=t.map((function(e){var t=e.asset,o=e.id,s=e.score,a=e.title,c=e.title_color;return{animationURL:t.animation_url||void 0,id:o,imageMenuURL:r(t.images,i),imagePreviewURL:r(t.preview_images,n),score:s,title:a,titleColor:c}})),a={};return s.forEach((function(e){a[e.id]=e})),{id:e,items:s,itemsById:a}},c=function(e){return Number.isInteger(e)&&e>=i.REACTION_ID_MIN&&e<=i.REACTION_ID_MAX},l=function(e){return void 0===e||c(e)},d=function(e){var t=parseInt(e,10);if(c(t))return t},u=function(e,t){if(e.length<i.REACTION_SET_ITEMS_MIN_COUNT)return{error:new Error("Invalid reactions items count in set '"+t+"': "+e.length)}}},zuld:function(e,t,o){"use strict";o.r(t);o("rGqo"),o("Btvt"),o("Oyvg"),o("OG14"),o("pIFo");var i=o("v+DW");t.default={init(e,t){e.setOptions({bodyStyle:"padding:0;",onDestroy:function(){uiSearch.destroy(r),s&&s.destroy(),e=o=s=a=r=null}});var o,n,s,r=ge("video_live_blacklist_search"),a=ge("video_live_blacklist_wrap"),c=domByClass(a,"olist"),l={};function d(e){var i=e;if((e=trim(e).replace(/\s+/g," ").toLowerCase())!==n){n=e;var s=e?o.search(e):t.list,r="";if(s.length)for(var a,d=new RegExp(e,"i"),u=0;u<s.length;u++)a=s[u],r+=getTemplate("video_live_blacklist_item",{id:a.id,href:a.href,photo:a.photo,name:e?a.name.replace(d,"<em>$&</em>"):a.name,class:l[a.id]?" olist_item_wrap_on":""});else r=getTemplate("video_live_blacklist_empty",{text:langStr(getLang("global_search_not_found"),"search","<b>"+clean(i)+"</b>")});val(c,r)}}t.list.length&&(e.removeButtons().addButton(getLang("global_save"),(function(o){ajax.post("al_video.php?act=save_live_blacklist",{exclude:Object.keys(l).join(","),hash:t.save_hash},{onDone:function(t){e.hide(),t&&showDoneBox(t)},showProgress:i.lockButton.pbind(o),hideProgress:i.unlockButton.pbind(o)})})).addButton(getLang("global_cancel"),null,"no"),s=new uiScroll(a),d(""),a.onclick=function(e){var t=domClosest("olist_item_wrap",e.target);if(!t)return;cancelEvent(e);var o=domData(t,"id");toggleClass(t,"olist_item_wrap_on")?l[o]=1:delete l[o]},r&&(o=new vkIndexer(t.list,(function(e){return e.name+" https://vk.com"+e.href})),uiSearch.init(r,{onChange:d}),uiSearch.focus(r)))}}}});