!function(_){function e(e){for(var s,n,o=e[0],c=e[1],u=e[2],l=0,d=[];l<o.length;l++)n=o[l],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&d.push(i[n][0]),i[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(_[s]=c[s]);for(a&&a(e);d.length;)d.shift()();return t.push.apply(t,u||[]),r()}function r(){for(var _,e=0;e<t.length;e++){for(var r=t[e],s=!0,o=1;o<r.length;o++){var c=r[o];0!==i[c]&&(s=!1)}s&&(t.splice(e--,1),_=n(n.s=r[0]))}return _}var s={},i={"web/friends":0},t=[];function n(e){if(s[e])return s[e].exports;var r=s[e]={i:e,l:!1,exports:{}};return _[e].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.e=function(){return Promise.resolve()},n.m=_,n.c=s,n.d=function(_,e,r){n.o(_,e)||Object.defineProperty(_,e,{enumerable:!0,get:r})},n.r=function(_){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_,"__esModule",{value:!0})},n.t=function(_,e){if(1&e&&(_=n(_)),8&e)return _;if(4&e&&"object"==typeof _&&_&&_.__esModule)return _;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:_}),2&e&&"string"!=typeof _)for(var s in _)n.d(r,s,function(e){return _[e]}.bind(null,s));return r},n.n=function(_){var e=_&&_.__esModule?function(){return _.default}:function(){return _};return n.d(e,"a",e),e},n.o=function(_,e){return Object.prototype.hasOwnProperty.call(_,e)},n.p="/js/cmodules/";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var a=c;t.push([177,"common"]),r()}({"0oR3":function(_,e,r){"use strict";r.r(e),r.d(e,"CALL_ENTRY_POINT_FRIENDS_LIST_ACTION",(function(){return s})),r.d(e,"FRIENDS_LIST_FRIEND_OPTIONS_INDEX",(function(){return i}));var s="friends_list",i=13},177:function(_,e,r){_.exports=r("Bg1q")},Bg1q:function(_,e,r){"use strict";r.r(e);var s=r("Fu+V");window.Friends=s.default;try{stManager.done(jsc("web/friends.js"))}catch(_){}},"Fu+V":function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("HEwt"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("a1Th"),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("Btvt"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("rGqo"),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("rE2o"),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("ioFf"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("KKXr"),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("Oyvg"),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("OG14"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("pIFo"),core_js_modules_es6_array_sort__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("Vd3H"),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("98sY"),_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("XzvV"),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("ryw6"),_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("zxIV"),_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("v+DW"),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("t7n3"),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("EasH"),_web_lib_lang__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("4+be"),_friends_constants__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("0oR3");function _slicedToArray(_,e){return _arrayWithHoles(_)||_iterableToArrayLimit(_,e)||_unsupportedIterableToArray(_,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(_,e){if(_){if("string"==typeof _)return _arrayLikeToArray(_,e);var r=Object.prototype.toString.call(_).slice(8,-1);return"Object"===r&&_.constructor&&(r=_.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(_,e):void 0}}function _arrayLikeToArray(_,e){(null==e||e>_.length)&&(e=_.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=_[r];return s}function _iterableToArrayLimit(_,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(_)){var r=[],s=!0,i=!1,t=void 0;try{for(var n,o=_[Symbol.iterator]();!(s=(n=o.next()).done)&&(r.push(n.value),!e||r.length!==e);s=!0);}catch(_){i=!0,t=_}finally{try{s||null==o.return||o.return()}finally{if(i)throw t}}return r}}function _arrayWithHoles(_){if(Array.isArray(_))return _}var drawFriendTemplateOptions=(_,e)=>{if(e.isInvite)return{info_actions:""};var r=_[_friends_constants__WEBPACK_IMPORTED_MODULE_19__.FRIENDS_LIST_FRIEND_OPTIONS_INDEX],s=["all","online","recent"].includes(e.section)&&!!(null==r?void 0:r.show_call_button);return{info_actions:[Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.getTemplate)("friends_friend_info_action_write",{friend_id:_[0]}),s?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.getTemplate)("friends_friend_info_action_call",{friend_id:_[0]}):void 0].filter(_=>!!_).join('<span class="divider-pixels"></span>')}},Friends={init:function(_,e){extend(cur,{fSearchWrap:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_search_cont","friends"),fSearch:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("s_search"),fSearchFilterLnk:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("ui_search_fltr_control","market_search_wrap"),fSearchExtSearchLink:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("ui_search_fltr_ext_link","market_search_wrap"),module:"friends",fListEl:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_list"),showMore:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("show_more"),pageEnd:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("page_end"),fContent:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("list_content"),fSearchContent:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_search_cont"),friendsTpl:_,commonTpl:e,savedMasks:{},friends:{},timeouts:{}}),this.prevStr="",cur.secData||(cur.secData={}),cur.curList=cur.section,placeholderInit(cur.fSearch),setTimeout((function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)("friends_search_input_wrap")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.elfocus)(cur.fSearch)}),0),Friends.scrollNode=browser.msie6?pageNode:window,addEvent(Friends.scrollNode,"scroll",Friends.scrollResize),setTimeout((function(){cur.destroy.push((function(){clearTimeout(cur.resizeTimeout),removeEvent(Friends.scrollNode,"scroll",Friends.scrollResize)}))}),0),cur.silent||this.indexAll((function(){"list"==cur.section.substr(0,4)&&(cur.friendsList[cur.section]=Friends.filter(cur.friendsList.all,cur.section)),cur.friendsList[cur.section]&&cur.friendsList[cur.section].length||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_not_found")})),cur.nav.push(function(_,e,r){if("id"in _||"sort"in _||"act"in _||isEmpty(_))return!0;if("friends"==r[0]||"al_friends.php"==r[0]&&_.section){var s=_.section;return"requests"!=s&&"all_requests"!=s&&"out_requests"!=s||cur.requestsCount||cur.suggCount||cur.allRequestsCount||cur.outRequestsCount?"requests"!=s||cur.requestsCount||cur.suggCount?"all_requests"!=s||cur.allRequestsCount?("out_requests"!=s||cur.outRequestsCount)&&("subscribers"!=s||cur.subscribersCount)?("all"!=s&&"online"!=s&&"requests"!=s&&"all_requests"!=s&&"out_requests"!=s||__adsUpdate("force"),"all_requests"!=s||"sort"in _||cur.sortByCommon||(delete r.sort,setTimeout(Friends.changeSummary,0)),this.section(r.section,function(){this.changeSummary(),nav.setLoc(r)}.bind(this)),!1):nav.change({section:"all"}):nav.change({section:cur.requestsCount||cur.suggCount?"requests":"out_requests"}):nav.change({section:cur.allRequestsCount?"all_requests":"out_requests"}):nav.change({section:"all"})}return"al_friends.php"!=r[0]&&"friends"!=r[0]&&void 0}.bind(this)),cur.silent&&ajax.post("al_friends.php",{act:"load_friends_silent",id:cur.oid,gid:cur.gid,sort:nav.objLoc.sort,platform_id:nav.objLoc.platform_id},{onDone:(_,e,r)=>{if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(cur.showMore,"load_more"),cur.silent=!1,_){for(var s in cur.occupations=extend(cur.occupations||{},e),_)_.hasOwnProperty(s)&&(cur.friendsList[s]=_[s]);this.indexAll((function(){"list"==cur.section.substr(0,4)&&(cur.friendsList[cur.section]=Friends.filter(cur.friendsList.all,cur.section)),(cur.onSilentLoad||Friends.showMore)()})),r.cities&&stManager.add(["ui_controls.js","ui_controls.css"],(function(){cur.cityFilter.setData(r.cities),cur.cityFilterOpened&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_fltr_progress"),cur.cityFilter.showDefaultList())}))}},local:1})},indexAll:function(_){var e=cur.friendsList.all;cur.friendsDomains={},cur.friendsIndex=new window.vkIndexer(e,(function(_){var e=parseInt(_[0]);if(cur.friends&&e){cur.friends[e]=_;var r=(_[2].startsWith("/")?_[2].slice(1):_[2])||"";return r==="id"+e&&(r=""),r&&(cur.friendsDomains[r]=e),[_[5]||"",r].join(" ")}return""}),(function(){cur.silent||(cur.friendsList.online=Friends.filter(e,"online"),"common"==cur.section&&(cur.friendsList.common=Friends.filter(e,"common")),_&&_()),Friends.initBackFunc()})),"phonebook"==cur.section&&Friends.indexPhone()},indexPhone:function(){cur.phoneIndex=new window.vkIndexer(cur.friendsList.phonebook,(function(_){if(!_[11])return"";var e=_[11][0]||"",r=_[11][1]||"",s=_[11][2]||"",i=parseInt(_[0]),t=(_[2].startsWith("/")?_[2].slice(1):_[2])||"";return t==="id"+i&&(t=""),[_[5],e,e.replace(/[^0-9\+]/g,""),r,r.replace(/[^0-9\+]/g,""),s,t].join(" ")}))},initBackFunc:function(){cur._back={text:cur.backLang,show:[function(){addEvent(Friends.scrollNode,"scroll",Friends.scrollResize)}],hide:[function(){if(Friends.searchTimout&&clearTimeout(Friends.searchTimout),cur.timeouts)for(var _ in cur.timeouts)cur.timeouts.hasOwnProperty(_)&&clearTimeout(cur.timeouts);removeEvent(Friends.scrollNode,"scroll",Friends.scrollResize)}]}},switchTab:function(_,e,r){if(checkEvent(r))return!0;uiTabs.switchTab(_);var s={0:"friends",section:e};return checkEvent(r)||nav.change(s)},switchMenu:function(_,e,r){if(void 0!==_.href&&checkEvent(r))return!0;var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("ui_rmenu",_);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("ui_rmenu_item_sel",s)==_)return!1;uiRightMenu.switchMenu(_);var i={0:"friends",section:e};if(vk.id!=cur.oid)i.id=cur.oid;else if(cur.gid)return nav.change({section:e}),!1;return"find"==nav.objLoc.act&&uiRightMenu.showProgress(_),nav.go(i,r),scrollToTop(0),!1},filter:function(_,e){var r=_?_.length:0,s=[],i=0;"list"==e.substr(0,4)&&(i=parseInt(e.substr(4)),e="list");for(var t=0;t<r;t++){var n=_[t];if(!cur.filterIds||cur.filterIds[parseInt(n[0])])switch(e){case"online":intval(n[4])&&s.push(n);break;case"common":cur.commonCount&&n[11]&&s.push(n);break;case"list":parseInt(n[6])&1<<i&&s.push(n);break;default:s.push(n)}}return s},loadMore:function loadMore(start,end,forceSection){var section=forceSection||cur.section,list=cur.curList,curData=cur.secData[section],showMore="sugg_requests"==forceSection?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_search_more"):cur.showMore;curData.loading||(curData.loading=!0,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(showMore,"load_more"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)(showMore),ajax.post("/friends",extend({act:"get_section_friends",section,offset:start,id:cur.oid,gid:cur.gid,sort:nav.objLoc.sort},cur.filter),{onDone:function(data,preload){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(showMore,"load_more");var response=null;try{response=eval("("+data+")")}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_11__.logEvalError)(_,data)}cur.friendsList&&(cur.friendsList[list]||(cur.friendsList[list]=[]),"requests"==list&&response.sugg_requests?Array.prototype.push.apply(cur.friendsList.sugg_requests,response.sugg_requests):Array.prototype.push.apply(cur.friendsList[list],response[section]),this.showMore(!1,start,end),curData.loading=!1,curData.preload=preload)}.bind(this)}))},showMore:function(_,e,r,s){if(!cur.friendsList)return!1;var i=cur.curList,t=cur.friendsList[i],n=cur.friendsPerPage,o="requests"==cur.section&&!_&&cur.suggCount&&(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)(cur.showMore)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(cur.showMore,"manual")),c=cur.showMore,u=cur.section,a=cur.sectionCount,l=cur.shownFriends,d=Friends.isInvitePage();if(o||"requests"!=cur.section||!cur.suggCount||cur.shownFriends||e||(n=3,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(cur.showMore,"manual"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)(cur.showMore)),-1===_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(cur.showMore,"manual")&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(cur.showMore,"manual"),cur.pageEnd=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_search_wrap")),_=!1),!o){if(!t||!t.length){if(0==cur.shownFriends&&!cur.searchCount){if(cur.isLoading)return!1;cur.searchStr?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)("friends_not_found","friends_search"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("search_ph").innerHTML=cur.searchStr.replace(/([<>&#]*)/g,"")):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)("friends_not_found","friends_search"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)("friends_not_found","friends_only_other");var b="";b="list"==cur.curList.substr(0,4)?cur.filterIds?(b=cur.summaryLang.list_not_found_filter).replace("{link}",'<a onclick="Friends.clearFilter(true);">').replace("{/link}","</a>"):(b=cur.summaryLang.list_not_found).replace("{link}",'<a onclick="Friends.editList(-1);">').replace("{/link}","</a>"):"requests"==cur.section?cur.summaryLang.friends_no_friend_requests:cur.filter?(b=cur.summaryLang.not_found_filter).replace("{link}",'<a onclick="Friends.clearFilter(true);">').replace("{/link}","</a>"):cur.summaryLang.not_found,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_not_found_text").innerHTML=b,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_not_found")}return _&&(cur.fContent.innerHTML=""),cur.searchCount&&Friends.serverSearchMore(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("show_more","friends_search_more"),void("requests"==cur.section&&_&&cur.suggCount&&(cur.fSearchContent.innerHTML="",this.showMore(!1,e,r,s),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_search_wrap")))}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)("friends_not_found")&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_not_found"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)("friends_not_found","friends_only_other"))}o&&(t=(cur.friendsList.sugg_requests||[]).slice(),u="sugg_requests",a=cur.suggCount,c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_search_more"),l=cur.shownSugg),null==e&&(e=l),null==r&&(r=l+n);var E=t.slice(e,r);if(!E.length){var f=cur.secData[u];return f&&f.preload&&Friends.loadMore(e,r,u),cur.searchCount&&Friends.serverSearchMore(),void(l>=a&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(c))}var O=[];for(var h in _&&(cur.fContent.innerHTML=""),E)if(E.hasOwnProperty(h)){var M=E[h];if(cur.selection){var m=E[h].slice();m[5]=m[5].replace(cur.selection.re,cur.selection.val)}if(++l,o?++cur.shownSugg:++cur.shownFriends,M){var D="";o&&(D="sugg_requests");var P=drawFriendTemplateOptions(M,{isInvite:d,section:u});O.push(...Friends.drawFriend(M,D,P))}}if(s)return'<div class="friends_list_bl">'+O.join("")+"</div>";(o?cur.fSearchContent:cur.fContent).appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("div",{innerHTML:O.join(""),className:"friends_list_bl"})),l>=a?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(c),cur.pageEnd=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("page_end")):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)(c),!o&&"requests"==cur.section&&_&&-1!==_&&cur.suggCount&&(cur.fSearchContent.innerHTML="",this.showMore(!1,e,r,s),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_search_wrap"))},updateList:function(_,e){if(_||Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__.removeSearchPositionTracker)("friends"),cur.silent)return cur.onSilentLoad=function(){Friends.updateList(_,!0)},void(trim(_)&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(cur.showMore),cur.fContent.innerHTML='<div class="friends_wide_loading"></div>'));clearTimeout(Friends.searchTimout),Friends.searchTimout=setTimeout(function(){cur.searchStr!=_&&(cur.searchStr=_,_?("all"!=cur.section&&"phonebook"!=cur.section&&(this.selectTab("all"),this.selectSection("all"),cur.curList=cur.section="all",nav.setLoc(extend(nav.objLoc,{section:"all"}))),this.search(_,cur.section),this.changeSummary()):cur.section!=cur.curList||e?(this.showSection(),this.changeSummary(),this.showMore()):(this.hideLoading(),cur.searchCount=0,this.showMore()),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(cur.fSearchWrap,"ui_search_fixed")&&scrollToY(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_search_input_wrap").offsetTop,0))}.bind(Friends),10)},showSection:function(_){if(cur.shownFriends=cur.shownSugg=0,cur.curList=cur.section=_||cur.section,vk.id==cur.oid){var e="requests"==cur.section||"all_requests"==cur.section||"out_requests"==cur.section;if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)("friends","friends_phonebook"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)("friends","friends_requests"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(cur.fSearchFilterLnk,"friends_sort_control","friends_req_block",cur.fSearchExtSearchLink),e){("requests"==cur.section&&cur.requestsCount>50||"all_requests"==cur.section&&cur.allRequestsCount>10)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_sort_control"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_search_input_wrap","friends_search_header"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_sugg_header");var r=(cur.requestsCount||cur.suggCount?1:0)+(cur.allRequestsCount?1:0)+(cur.outRequestsCount?1:0);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.toggle)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_section_requests","narrow_column"),r>=1),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.toggle)("friends_tab_requests",cur.requestsCount>0||cur.suggCount>0),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.toggle)("friends_tab_all_requests",cur.allRequestsCount>0),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.toggle)("friends_tab_out_requests",cur.outRequestsCount>0),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)("friends","friends_requests"),val(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_friends_list","friends_req_block"),"")}else if("phonebook"==cur.section)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_search_input_wrap",cur.fSearchFilterLnk),Friends.showListHeader(cur.summaryLang.friends_filter_phonebook),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)("friends","friends_phonebook");else if("recent"==cur.section)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_search_input_wrap",cur.fSearchFilterLnk),Friends.showListHeader(cur.summaryLang.friends_tab_recently_added);else if("members"==cur.section)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_search_input_wrap",cur.fSearchExtSearchLink);else if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_sugg_header"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_search_input_wrap","friends_search_header",cur.fSearchFilterLnk),cur.requestsCount&&cur.friendsList.requests){var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_req_block");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_friends_list",s).innerHTML=cur.commonTpl(cur.friendsList.requests[0],"requests").join(""),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)(s)}val(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_label",cur.showMore),e?cur.summaryLang.friends_show_more_requests:cur.summaryLang.friends_show_more_friends)}else cur.gid||("subscribers"==cur.section?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_search_input_wrap"),Friends.showListHeader(cur.summaryLang.friends_tab_subscribers)):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_search_input_wrap"));Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)("friends_search_input_wrap")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.elfocus)(cur.fSearch),cur.filterIds&&(cur.curList+="_filter");var i,t=cur.friendsList[cur.curList];if(t||(i="recent"==_||"phonebook"==_||"requests"==_?_:"all",t=cur.friendsList[cur.curList]=this.filter(cur.friendsList[i],cur.section)),cur.sectionCount=t?t.length:0,cur.selection=!1,cur.filter&&!cur.filterIds)return Friends.changeFilter(),cur.searchStr||this.clearServerSearch(),!1;this.showMore(!0)},updateView:function(){cur.fContent.innerHTML=this.showMore(!1,0,cur.shownFriends,!0)},showLoading:function(){cur.isLoading=1,uiSearch&&uiSearch.showProgress("s_search")},hideLoading:function(){cur.isLoading=0,uiSearch&&uiSearch.hideProgress("s_search")},serverSearchMore:function(){"requests"!=cur.section?cur.serverLoadingMore||cur.searchFinished||(cur.serverLoadingMore=!0,ajax.post("friends",{act:"server_search",q:cur.searchStr,offset:cur.searchOffset},{onDone:function(_,e,r){cur.searchFinished=!e,cur.searchFinished&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_search_more"),cur.searchOffset=r,cur.serverLoadingMore=!1,_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_search_cont").appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("div",{innerHTML:_,className:"friends_list_bl"}))},showProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_search_more"),"load_more")},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_search_more"),"load_more")}})):Friends.showMore()},serverSearch:function(_,e,r,s){cur.searchCount=0,Friends.showLoading(),cur.serverSearchStr=_,clearTimeout(cur.serverSearchTimeout);var i=[];for(var t in r)r.hasOwnProperty(t)&&i.push(r[t][0]);var n=+new Date;cur.serverSearchTimeout=setTimeout(()=>{ajax.post("friends",{act:"server_search",q:_,exclude:i.join(",")},{onDone:function(r,i,t){var o=+new Date-n;Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__.saveSearchAttemptStats)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__.serviceFriends,0,i,cur.serverSearchStr,s,0,o,"",_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__.blockNameSearch),cur.searchOffset=t,cur.searchFinished=!i,Friends.hideLoading(),cur.searchStr==_&&(cur.searchCount=i,0==cur.shownFriends&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_search_wrap"),cur.fContent.innerHTML="",Friends.showMore()),i?(cur.searchFinished?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_search_more"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_search_more"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_search_cont").innerHTML='<div class="friends_list_bl">'+r+"</div>",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_search_wrap"),Friends.changeSummary(),e?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)("friends_not_found","friends_only_other"):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)("friends_not_found","friends_only_other"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)("friends_not_found","friends_search"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_not_found"))):Friends.changeSummary())},onFail:Friends.hideLoading})},300)},clearServerSearch:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_search_wrap"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_search_more"),cur.searchCount=0,cur.pageEnd=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("page_end")},goToSearch:function(_){nav.go("friends?act=find&c%5Bname%5D=1&c%5Bq%5D="+encodeURIComponent(cur.searchStr)+"&c%5Bsection%5D=people&c[per_page]=40")},search:function(_,e,r,s){var i,t,n,o=Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__.generateQID)();cur.shownFriends=0,cur.section=e;var c=0,u=_slicedToArray(extractUserParameters(_),2),a=u[0],l=u[1];if(a?c=a:l&&cur.friendsDomains&&cur.friendsDomains[l]&&(c=Number(cur.friendsDomains[l]),Number.isNaN(c)&&(c=0)),_){if(t="phonebook"==e?cur.phoneIndex:cur.friendsIndex,-1==_)i="phonebook"==e?e:"all",n=this.filter(cur.friendsList[i],e),(_="")!=cur.searchStr&&this.clearServerSearch();else{if(c&&cur.friends){var d=cur.friends.hasOwnProperty(c)?cur.friends[c]:null;d&&(n=[d])}n||(n=t.search(_)),cur.filterIds&&(n=this.filter(n,e));var b=n.length;if(b&&(_==cur.serverSearchStr||cur.sectionCount||this.clearServerSearch()),_.trim()!==this.prevStr){var E=cur.oid==vk.id?_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__.serviceFriends:_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__.serviceUserFriends;Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__.saveSearchAttemptStats)(E,0,b,_,o,0,"0","",_web_lib_stats__WEBPACK_IMPORTED_MODULE_12__.blockNameOwn)}b<5&&cur.oid==vk.id&&!cur.gid&&"phonebook"!=e&&_.trim()!==this.prevStr&&this.serverSearch(_,b,n,o),this.prevStr=_.trim()}var f=cur.section;if(cur.filterIds&&(f+="_filter"),_&&(f+="_search_"+_),cur.curList==f&&!s)return;cur.curList=f,cur.friendsList[cur.curList]=n;var O={all:1,online:1,common:1};if(""==_&&cur.filterIds&&O[e])for(var h in delete O[e],O)cur.friendsList[h]&&(n=this.filter(cur.friendsList[i],h),cur.friendsList[h+"_filter"]=n);_&&(_+=" "+(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_18__.parseLatin)(_)||""),_=trim(escapeRE(_.replace(/[,]/g,""))),cur.selection={re:new RegExp("("+_.replace(t.delimiter,"|").replace(/(^\||\|$|\?)/g,"")+")","gi"),val:'<em class="highlight">$1</em>'})}else cur.curList=cur.section,cur.selection=!1,cur.searchStr&&this.clearServerSearch();cur.sectionCount=cur.friendsList[cur.curList].length,this.searchTimout=setTimeout(function(){this.showMore(!0),r&&(Friends.onSectionChange(),r())}.bind(this),10)},changeSummary:function(_){var e={all:cur.allFriendsCount,common:cur.commonCount};if(cur.friendsList.online&&(e.online=cur.friendsList.online.length),cur.gid||vk.id!=cur.oid||(e=extend(e,{requests:cur.requestsCount?cur.requestsCount:"",all_requests:cur.allRequestsCount,out_requests:cur.outRequestsCount})),"list"==cur.curList.slice(0,4)||"phonebook"==cur.curList.slice(0,9))Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_list_count").innerHTML=cur.sectionCount?langNumeric(cur.sectionCount,"%s",!0):"";else if("subscribers"==cur.section)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_list_count").innerHTML=cur.subscribersCount?langNumeric(cur.subscribersCount,"%s",!0):"";else if("requests"==cur.section&&cur.suggCount)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_sugg_count").innerHTML=cur.suggCount?langNumeric(cur.suggCount,"%s",!0):"";else if(-1!=cur.curList.indexOf("_search_")||cur.filterIds){if("all"==cur.section){if(!cur.sectionCount&&!cur.searchCount&&cur.isLoading)return;e.all=cur.sectionCount}else e.all=cur.friendsList.all_filter.length;-1==cur.curList.indexOf("_search_")?(cur.friendsList.online_filter&&(e.online=cur.friendsList.online_filter.length),cur.friendsList.common_filter&&(e.common=cur.friendsList.common_filter.length)):e.online=e.common=""}if(each(e,(function(_,e){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_tab_"+_);if(r){var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("ui_tab_count",r);s&&(s.innerHTML=e?langNumeric(e,"%s",!0):"")}})),!cur.gid&&vk.id==cur.oid){var r=intval(e.requests+cur.suggCount);r=r?langNumeric(r,"%s",!0):"",val(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("ui_rmenu_count","ui_rmenu_requests"),r),val(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("page_block_header_count","friends_req_block"),r),(r>1?_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(domPN(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_request_load_more")))}document.title=replaceEntities(stripHTML(cur.htitles[cur.section]||cur.htitles.all))},showListHeader:function(_,e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_list_title").innerHTML=_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_list_count").innerHTML="",each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("_friends_header",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_tabs_wrap")),(function(){"friends_tab_list"===this.id?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(this,"unshown"),e?vk.id==cur.oid&&((e<25?_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_list_delete_btn"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_list_edit_btn")):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_list_edit_btn","friends_list_delete_btn")):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(this,"unshown")}))},selectTab:function(_){_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("ui_tab","friends_tab_"+_);var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("ui_tabs",_);each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("_friends_header",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_tabs_wrap")),(function(){this==e?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(this,"unshown"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(this,"unshown")})),uiTabs.switchTab(_)},selectSection:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_section_"+_,"narrow_column");e&&uiRightMenu.switchMenu(e)},selectTabAndSection:function(_){if("all"==_||"online"==_||"common"==_||"members"==_)this.selectTab(_),this.selectSection("all");else if("all_requests"==_||"requests"==_||"out_requests"==_)this.selectTab(_),this.selectSection("requests");else if("list"==_.substr(0,4)){var e=parseInt(_.substr(4)),r="";r=e>=25&&e<=29?cur.publicLists[e]:cur.userLists[e],this.showListHeader(r,e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)("ui_rmenu_lists_list")||uiRightMenu.toggleSubmenu("lists"),this.selectSection(_)}else this.selectTab("all"),this.selectSection(_)},onSectionChange:function(){window.tooltips&&tooltips.hideAll()},section:function(_,e,r){if(Friends.clearServerSearch(),_||(_="all"),r||("online"!=_||cur.oid==vk.id)&&-1==_.indexOf("requests")&&"recent"!=_&&"members"!=_||"list"==_.substr(0,4)||(Friends.clearFilter(),Friends.updateCurFilters()),_||(_=cur.requestsCount&&cur.requestsCount>0&&cur.requestsCount<100||cur.suggCount?"requests":"all"),cur.requestsCount||cur.suggCount||cur.allRequestsCount||cur.outRequestsCount||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_section_requests","narrow_column")),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_req_block"),_!=cur.section&&(cur.fSearch.setValue(""),cur.searchStr=""),this.selectTabAndSection(_),cur.silent&&"out_requests"!=_)return cur.onSilentLoad=function(){Friends.section(_,e)},void(_!=cur.section&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(cur.showMore),cur.fContent.innerHTML='<div class="friends_wide_loading"></div>'));if(cur.secData[_]||(cur.secData[_]={}),!r&&cur.friendsList[_]||"all"==_||"requests"==_&&cur.friendsList.sugg_requests)return this.showSection(_),e(),Friends.onSectionChange(),void(cur.filter&&Friends.changeFilter());switch(_){case"online":case"common":this.search(-1,_,e);break;case"phonebook":var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_section_phonebook","narrow_column");uiRightMenu.showProgress(s),ajax.post("/al_friends.php",{act:"phonebook",id:nav.objLoc.id},{onDone:function(r){if(r){cur.shownFriends=0,cur.curList=cur.section=_;var i=cur.friendsList.all,t=[];if(i)for(var n=0,o=i.length;n<o;n++){var c=i[n],u=r[c[0]];u&&(c.push(u),t.push(c))}if(t.sort((function(_,e){return _[5].localeCompare(e[5],{sensitivity:"base"})})),cur.friendsList[cur.section]=t,cur.sectionCount=t.length,cur.fContent.innerHTML="",uiRightMenu.hideProgress(s),Friends.showSection(_),Friends.onSectionChange(),e(),Friends.indexPhone(),cur.filterIds)return cur.curList+="_filter",Friends.search(cur.searchStr||-1,cur.section,!1,!0),void Friends.changeSummary();this.showMore()}}.bind(this)});break;case"recent":var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_section_recent","narrow_column");uiRightMenu.showProgress(i),ajax.post("/al_friends.php",{act:"recent"},{onDone:function(r){if(r){cur.shownFriends=0,cur.curList=cur.section=_;for(var s=[],t=r.length,n=0;n<t;n++){var o=cur.friends[r[n]];o&&s.push(o)}cur.friendsList[cur.section]=s,cur.sectionCount=s.length,cur.fContent.innerHTML="",uiRightMenu.hideProgress(i),Friends.showSection(_),Friends.onSectionChange(),e(),this.showMore()}}.bind(this)});break;case"out_requests":cur.fContent.innerHTML='<div class="friends_wide_loading"></div>',ajax.post("/friends",{act:"out_requests"},{onDone:(r,s)=>{r&&(extend(cur.occupations,s),extend(cur.friendsList,r),this.indexAll((function(){Friends.section(_,e)})))}});break;default:"list"==_.substr(0,4)&&this.search(-1,_,e)}},scrollResize:function(){if(!browser.mobile){var _=document.documentElement,e=window.innerHeight||_.clientHeight||bodyNode.clientHeight,r=scrollGetY();cur.pageEnd&&(r+3*e>cur.pageEnd.offsetTop&&setTimeout((function(){Friends.showMore()}),0),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)("friends_search_input_wrap"))}},drawFriend:function(_,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return 0===(null==_?void 0:_.length)?[]:"requests"==cur.section||"all_requests"==cur.section||"out_requests"==cur.section?cur.commonTpl(_,e||cur.section):cur.friendsTpl(_,cur.section,r)},inviteToGroup:function(_,e,r,s,i){var t=function(s){for(var i in cur.friendsList[cur.curList])if(cur.friendsList[cur.curList].hasOwnProperty(i)){var t=cur.friendsList[cur.curList][i],n=void 0;if(t[0]==r){t[11]=s,n=s?`<button class="flat_button button_small button_wide secondary" onclick="return Friends.inviteToGroup(this, ${e}, ${r}, 1, '${t[12]}')">${getLang("friends_cancel_invite")}</button>`:`<button class="flat_button button_small button_wide" onclick="return Friends.inviteToGroup(this, ${e}, ${r}, 0, '${t[12]}')">${getLang("friends_send_invite")}</button>`,_.parentNode.replaceChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.se)(n),_);break}}};return s?ajax.post("/al_page.php",{act:"a_cancel_invite",mid:r,gid:e,hash:i},{onDone:function(_){t(0)},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.lockButton.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.unlockButton.pbind(_)}):ajax.post("/al_page.php",{act:"a_invite",mid:r,gid:e,hash:i},{onDone:function(e,s){e?t(1):(Object(_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_13__.showMsg)("res"+r,s,"msg"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(_))},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.lockButton.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.unlockButton.pbind(_)}),!1},acceptRequest:function(_,e,r,s){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("request_controls_"+_);r||(i.innerHTML='<div class="progress_inline"></div>'),ajax.post("al_friends.php",{act:"add",mid:_,hash:e,request:1,select_list:1},{onDone:function(e){i.innerHTML=e,Friends.processRequest(_,!0,s),TopNotifier&&!TopNotifier.shown()&&TopNotifier.invalidate()},onFail:function(_){if(_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(getLang("global_error"),_),!0},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.lockButton.pbind(r),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.unlockButton.pbind(r)})},declineRequest:function(_,e,r){var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("request_controls_"+_);r||(s.innerHTML='<div class="progress_inline"></div>'),ajax.post("al_friends.php",{act:"remove",mid:_,hash:e,report_spam:1,from_section:cur.section},{onDone:function(e){cur.declinedRequestsCnt=cur.declinedRequestsCnt+1||1,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("friends_user_row",s),"friends_user_request")&&cur.declinedRequestsCnt>=2&&cur.requestsCount>1&&(e+='<button class="friends_decline_all flat_button button_small secondary" onclick="Friends.subscribeAllRequests(this, \''+cur.declineAllHash+"')\">"+cur.summaryLang.friends_hide_all_requests+"</button>"),s.innerHTML=e,Friends.processRequest(_,!1),TopNotifier&&!TopNotifier.shown()&&TopNotifier.invalidate()},onFail:function(_){if(_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(getLang("global_error"),_),!0},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.lockButton.pbind(r),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.unlockButton.pbind(r)})},processRequest:function(_,e,r){if(cur.friendsList){for(var s=cur.friendsList[r?"sugg_requests":"requests"]||[],i=s.length,t=!1;i--;)if(s[i][0]==_){var n=s.splice(i,1)[0];r?--cur.suggCount:--cur.requestsCount,Friends.changeSummary(),e?(t=!0,n.pop(),cur.friendsList.all?cur.friendsList.all.push(n):cur.friendsList.all=[n],cur.friends[n[0]]=n):r?(cur.shownSugg--,cur.suggCount--):(cur.shownFriends--,cur.sectionCount--)}if(e){for(var o=cur.friendsList.all_requests||[],c=o.length;c--;)if(o[c][0]==_){var u=o.splice(c,1)[0];--cur.allRequestsCount,t||(u.pop(),cur.friendsList.all?cur.friendsList.all.push(u):cur.friendsList.all=[u],cur.friends[u[0]]=u)}delete cur.friendsList.recent,delete cur.friendsList.online,Friends.indexAll()}else for(var a=cur.friendsList.out_requests||[],l=a.length;l--;)a[l][0]==_&&--cur.outRequestsCount;if("all"===cur.section&&cur.friendsList.requests.length){var d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_friends_list","friends_req_block");if(d){var b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.se)(cur.commonTpl(cur.friendsList.requests[0],"requests").join(""));d.appendChild(b)}}}},actionPossible:function(_,e,r,s,i){if(window.tooltips&&tooltips.hide(s),cur.possibleAdded||(cur.possibleAdded={}),!cur.possibleAdded[_]){cur.possibleAdded[_]=1,i||(i=cur.module);var t,n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("right_list_row",s);return t=r?{act:"add",mid:_,hash:e,from:i,request:1}:{act:"hide_possible",mid:_,hash:e,from:i},ajax.post("al_friends.php",t,{onDone:function(_){r&&showDoneBox(_);var e=n.parentNode,s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("unshown",e);s&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domInsertBefore)(s,n),fadeOut(n,500,(function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)(n),s||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("right_list_row",e)||slideUp("friends_possible_block",100)})),s&&setTimeout(fadeIn.pbind(s,200,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass.pbind(s,"unshown")),500)},onFail:function(_){if(_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(getLang("global_error"),_),!0}}),r&&cur.friendsList&&(delete cur.friendsList.out_requests,cur.outRequestsCount++,this.changeSummary("out_requests"),"out_requests"==cur.section&&nav.change({section:"out_requests"})),!1}},actionCall:(_,e,r,s)=>{var i,t,n;e.preventDefault(),r?(null===(i=window.Calls)||void 0===i?void 0:i.call)?null===(t=window.Calls)||void 0===t||null===(n=t.call)||void 0===n||n.call(t,r,s,void 0,_friends_constants__WEBPACK_IMPORTED_MODULE_19__.CALL_ENTRY_POINT_FRIENDS_LIST_ACTION):console.warn("Calls module is not available"):console.warn("Missing peer id",r,_)},actionFindUser:function(_,e,r,s){window.tooltips&&tooltips.hide(s);var i,t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("friends_find_user",s),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_find_user_result",t);return n.innerHTML='<div class="progress_inline"></div>',i=r?{act:"add",mid:_,hash:e,from:"possible"}:{act:"hide_possible",mid:_,hash:e},ajax.post("al_friends.php",i,{onDone:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(t,"touched"),n.innerHTML=_},onFail:function(_){if(_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(getLang("global_error"),_),!0},showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass.pbind(t,"loading"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass.pbind(t,"loading")}),!1},actionFindUserCancel:function(_,e,r,s){var i,t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("friends_find_user",s);return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_find_user_result",t).innerHTML='<div class="progress_inline"></div>',Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(t,"touched"),i=r?{act:"remove",mid:_,hash:e}:{act:"cancel_hide_possible",mid:_,hash:e},ajax.post("al_friends.php",i,{onDone:function(_){},onFail:function(_){if(_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(getLang("global_error"),_),!0},showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass.pbind(t,"loading"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass.pbind(t,"loading")}),!1},reportSpam:function(_,e,r){var s=r?domPN(r):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("request_controls_"+_);s||(s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("result_msg"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(s,"msg")),setTimeout(val.pbind(s,'<div class="progress_inline"></div>'),0),ajax.post("al_friends.php",{act:"report_spam",mid:_,hash:e},{onDone:function(_){s.innerHTML=_}})},restoreFriend:function(_,e){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("_actions_menu",_);ajax.post("al_friends.php",{act:"add",mid:e,hash:cur.userHash,cats:cur.savedMasks[e]},{onDone:Friends.onRemoveFriend.pbind(e,!0),showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass.pbind(r,"action_progress"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass.pbind(r,"action_progress")})},deleteFriend:function(_,e,r){var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("_actions_menu",r);return ajax.post("al_friends.php",{act:"remove",mid:e,hash:cur.userHash},{onDone:Friends.onRemoveFriend.pbind(e,!1),showProgress:function(){uiActionsMenu.hide(s),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(s,"action_progress")},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(s,"action_progress")}}),!1},onRemoveFriend:function(_,e){for(var r in cur.friendsList)"all"!=r&&"requests"!=r&&"all_requests"!=r&&"out_requests"!=r&&delete cur.friendsList[r];_=positive(_);var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_user_row"+_),i=cur.friends[_];i&&s?(e?(i[6]=cur.savedMasks[_],delete cur.savedMasks[_]):(cur.savedMasks[_]=i[6],i[6]=0),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.toggleClass)(s,"deleted",!i[6])):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)(s),Friends.indexAll((function(){}))},showCommonBox:function(_,e){return showTabbedBox("al_page.php",{act:"box",oid:e,tab:"common"},{cache:1},_),!1},toList:function(_){var e="list"+_;return nav.change({0:"al_friends.php",section:e}),scrollToTop(0),!1},searchFriendToggle:function(_,e,r){var s=r?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_subsc"+_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_unsubsc"+_),i=r?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_unsubsc"+_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_subsc"+_);ajax.post("al_friends.php",{act:r?"add":"remove",mid:_,hash:e,from:"friends"},{onDone:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(s),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)(i)},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.lockButton.pbind(s),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.unlockButton.pbind(s)})},checkCat:function(_,e,r,s){var i,t;1==s?i=isChecked(_):(i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(_,"checked"),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("lists"+e));var n=cur.friends[e];if(!n)return!1;n[6]=parseInt(n[6]),i?(n[6]&1<<r&&(n[6]-=1<<r),t&&(t.innerHTML=Friends.getLists(n[6]))):(n[6]&1<<r||(n[6]+=1<<r),t&&(t.innerHTML=Friends.getLists(n[6]))),1==s?checkbox(_):(i?_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(_,"checked"),cur.timeouts["list"+e]&&clearTimeout(cur.timeouts["list"+e]),delete cur.friendsList["list"+r],delete cur.friendsList["list"+n[6]],cur.timeouts["list"+e]=setTimeout((function(){ajax.post("al_friends.php",{act:"save_cats",uid:e,cats:n[6],hash:cur.userHash},{onDone:function(_){if(s){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_added_"+e);!cur["fr_add_text_"+e]&&r&&(cur["fr_add_text_"+e]=r.innerHTML),fadeTo(r,100,0,(function(){r.innerHTML=_,fadeTo(r,100,1)})),clearTimeout(cur["fr_add_timeout_"+e]),cur["fr_add_timeout_"+e]=setTimeout((function(){fadeTo(r,100,0,(function(){r.innerHTML=cur["fr_add_text_"+e],fadeTo(r,100,1)}))}),2e3)}}})}))},getLists:function(_){for(var e=[],r=29;r>=25;r--)1<<r&_&&cur.publicLists[r]&&e.push('<span class="friends_lists_group group',(r-1)%8+1,'" onmousedown="Friends.toList(',r,');">',cur.publicLists[r],"</span>");if(vk.id==cur.oid)for(var s in cur.userLists)1<<s&_&&!cur.publicLists[s]&&cur.userLists[s]&&e.push('<span class="friends_lists_group group',(s-1)%8+1,'" onmousedown="Friends.toList(',s,');">',cur.userLists[s],"</span>");return e.join("")},subscribeAllRequests:function(_,e){Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(cur.summaryLang.global_action_confirmation,cur.summaryLang.friends_confirm_subscribe_all_requests,getLang("box_yes"),(function(){ajax.post("al_friends.php",{act:"subscribe_all_requests",hash:e,once:1},{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.lockButton.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.unlockButton.pbind(_)})}),getLang("box_no"))},hideAllSuggs:function(_,e){Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(cur.summaryLang.global_action_confirmation,cur.summaryLang.friends_confirm_hide_all_suggs,getLang("box_yes"),(function(){ajax.post("al_friends.php",{act:"hide_all_suggs",hash:e},{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.lockButton.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.unlockButton.pbind(_)})}),getLang("box_no"))},editList:function(_){if(cur.silent)cur.onSilentLoad=function(){Friends.editList(_)};else{var e=[];if(-1==_&&(_=intval(cur.curList.substr(4))),_)for(var r=Friends.filter(cur.friendsList.all,cur.curList),s=r.length;s--;)e.push(r[s][0]);else _=0;showTabbedBox("al_friends.php",{act:"select_friends_box",Checked:e.join(","),from:"list",list_name:_?replaceEntities(stripHTML(cur.userLists[_])):"",list_id:_},{stat:[jsc("web/privacy.js"),"ui_controls.js","ui_controls.css"],cache:1,onFail:function(_){return setTimeout(Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(getLang("global_error"),_).hide,3e3),!0}}),cur.onFlistSave=function(e,r,s,i){var t=[];for(var n in r)r.hasOwnProperty(n)&&t.push(parseInt(n));return ajax.post("al_friends.php",{act:"save_list",title:i,cat_id:_,Friends:t.join(","),hash:s},{onDone:function(e,r){Friends.editListClient(_,e,r,t)},onFail:function(_){return setTimeout(Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(getLang("global_error"),_,getLang("global_close")).hide,4e3),!0}}),Friends.clearFilter(),Friends.updateCurFilters(),!1}}},editListClient:function(_,e,r,s){var i="list"+e;if(0==_){var t=`<div onclick="return Friends.switchMenu(this, 'list${e}', event);"  class="ui_rmenu_subitem ui_rmenu_item_sel friends_section_list${e}">${r}</div>`;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("ui_rmenu_lists_list").insertBefore(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("div",{innerHTML:t}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_create_list","narrow_column"));var n=s.length,o=1<<parseInt(e);for(cur.friendsList[i]=[];n--;){var c=cur.friends[s[n]];c[6]=parseInt(c[6]),c[6]&o||(c[6]+=o,cur.friendsList[i].push(c))}return cur.userLists[e]=r,Friends.indexAll(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("main_class"),"no_lists"),nav.change({0:"friends",section:i})}e<25&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_section_list"+e,"narrow_column").innerHTML=r,cur.userLists[e]=r);var u=1<<e;for(var a in cur.friendsList[i]=[],cur.friends)if(cur.friends.hasOwnProperty(a)){var l=cur.friends[a],d=-1!=s.indexOf(parseInt(l[0]));d&&cur.friendsList[i].push(l),l[6]=parseInt(l[6]),l[6]&u?d||(l[6]-=u):d&&(l[6]+=u)}return Friends.indexAll(),Friends.section(i,(function(){Friends.changeSummary(),nav.setLoc({0:"friends",section:i})}))},createList:function(_){return Friends.editList(0),cancelEvent(_)},deleteList:function(_){-1==_&&(_=intval(cur.curList.substr(4))),showBox("al_friends.php",{act:"delete_list_box",list_id:_})},deleteListClient:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("friends_section_list"+_,"narrow_column"));var e=1<<_;for(var r in cur.friends)cur.friends[r][6]&e&&(cur.friends[r][6]-=e);delete cur.userLists[_];var s=0;for(var i in cur.userLists)cur.userLists.hasOwnProperty(i)&&s++;return s||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("main_class"),"no_lists"),nav.change({0:"friends",section:"all"})},selectList:function(_,e,r){Friends.ddShow(e,_,r)},showListsDD:function(_,e,r){var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("ui_actions_menu",e),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("ui_actions_menu_sublist",s);if(i){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.data)(i,"hidetimer");return clearTimeout(t),void Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.data)(i,"hidetimer",0)}var n=cur.friends[parseInt(_)];if(n){for(var o,c=parseInt(n[6]),u=[],a=[28,29,27,25,26],l=0;l<5;++l)o=a[l],cur.publicLists[o]&&u.push('<a class="ui_actions_menu_item'+(c&1<<parseInt(o)?" checked":"")+'" onclick="Friends.checkCat(this, '+_+", "+o+');">'+cur.publicLists[o]+"</a>");for(var d in cur.userLists)if(d<25){var b=cur.userLists[d];b.length>20&&(b=trim(b.substr(0,18))+"..."),u.push('<a class="ui_actions_menu_item'+(c&1<<parseInt(d)?" checked":"")+'" onclick="Friends.checkCat(this, '+_+", "+d+');">'+b+"</a>")}u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.se)('<div class="ui_actions_menu_sublist shown" onmouseover="Friends.showListsDD('+_+', this, event);" onmouseout="Friends.hideListsDD(this);" onclick="Friends.showListsDD('+_+', this, event);">'+u.join("")+"</div>"),s.appendChild(u)}},hideListsDD:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("ui_actions_menu",_),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("ui_actions_menu_sublist",e);r&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.data)(r,"hidetimer")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.data)(r,"hidetimer",setTimeout((function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.data)(r,"hidetimer",0),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)(r)}),150)))},hideSuggestion:function(_,e,r){var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("request_controls_"+_);ajax.post("al_friends.php",{act:"hide_suggestion",mid:_,hash:e,report_spam:1},{onDone:function(e){cur.hiddenSuggestionsCnt=cur.hiddenSuggestionsCnt+1||1,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("friends_user_row",s),"friends_user_request")&&cur.hiddenSuggestionsCnt>=2&&cur.suggCount>1&&(e+='<button class="friends_decline_all flat_button button_small secondary" onclick="Friends.hideAllSuggs(this, \''+cur.declineAllHash+"')\">"+cur.summaryLang.friends_hide_all_suggs+"</button>"),s.innerHTML=e,Friends.processRequest(_,!1,!0)},onFail:function(_){if(_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(getLang("global_error"),_),!0},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.lockButton.pbind(r),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.unlockButton.pbind(r)})},addRecommend:function(_,e,r,s){(s=s.parentNode).innerHTML='<img src="/images/upload.gif" />',ajax.post("al_friends.php",{act:"a_suggest_friends",mid:_,uids:e,hash:r,from:"add"},{onDone:function(_){s.innerHTML=_},onFail:function(_){s.innerHTML=_}})},suggestBox:function(_){var e=showBox("al_friends.php",{act:"select_friends_box",from:"suggest_friends",friend_id:_},{stat:[jsc("web/privacy.js"),"privacy.css",jsc("web/indexer.js"),"profile.css"],params:{dark:1}});return e.leaveOnSave=!0,cur.onFlistSave=function(r,s,i){ajax.post("al_friends.php",{act:"a_suggest_friends",mid:_,ids:r.join(","),hash:i},{onDone:function(_){e.hide(),showDoneBox(_)},showProgress:e.showProgress,hideProgress:e.hideProgress})},!1},getAgeFromData:function(_,e){return!(_=parseInt(_))>0&&(_=e.ageTo),Friends.getRangeData(e.ageFrom,_,1,e.langAgeFrom+" ",e.langAgeFromEmpty)},getAgeToData:function(_,e){return!(_=parseInt(_))>0&&(_=e.ageFrom),Friends.getRangeData(_,e.ageTo,1,e.langAgeTo+" ",e.langAgeToEmpty)},getRangeData:function(_,e,r,s,i){if(_>e)return!1;var t=[[0,i]];if(r<0)for(var n=e;n>=_;n+=r)t.push([n,s+n]);else if(r>0)for(var o=_;o<=e;o+=r)t.push([o,s+o]);return t},radioFilter:function(_,e,r){radiobtn(_,e,"friends_radio_sex"),(r||null==r)&&Friends.changeFilter()},initFilters:function(_){stManager.add(["ui_controls.js","ui_controls.css"],(function(){cur.cityFilter=new Dropdown(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_fltr_city"),_.cities,{big:1,zeroPlaceholder:!0,onChange:Friends.changeFilter,onShow:function(){cur.silent&&(cur.cityFilterOpened=!0,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_fltr_progress"))}}),cur.ageFromFilter=new Dropdown(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_age_from"),Friends.getAgeFromData(_.ageTo,_),{zeroPlaceholder:!0,big:1,onChange:function(e){cur.ageToFilter.setData(Friends.getAgeToData(e,_)),Friends.changeFilter()}}),cur.ageToFilter=new Dropdown(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_age_to"),Friends.getAgeToData(_.ageFrom,_),{zeroPlaceholder:!0,big:1,onChange:function(e){cur.ageFromFilter.setData(Friends.getAgeFromData(e,_)),Friends.changeFilter()}}),window.radioBtns.friends_radio_sex={els:Array.prototype.slice.apply(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("radiobtn",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_radio_sex"))),val:0}}))},clearFilter:function(_,e){cur.cityFilter&&(e&&"city"!=e||cur.cityFilter.selectItem(0,!1),e&&"age_from"!=e||cur.ageFromFilter.selectItem(0,!1),e&&"age_to"!=e||cur.ageToFilter.selectItem(0,!1),e&&"sex"!=e||Friends.radioFilter(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_radio_any"),0,!1),cur.filterIds=!1,cur.filter=!1,_&&Friends.changeFilter())},filterParams:function(){var _={city:parseInt(cur.cityFilter.val()),sex:parseInt(radioBtns.friends_radio_sex.val),age_from:parseInt(cur.ageFromFilter.val()),age_to:parseInt(cur.ageToFilter.val())};return!!(_.city||_.sex||_.age_from||_.age_to)&&_},changeFilter:function(){if(cur.silent)return cur.onSilentLoad=function(){Friends.changeFilter()},Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(cur.showMore),void(cur.fContent.innerHTML='<div class="friends_wide_loading"></div>');if(cur.filter=Friends.filterParams(),cur.filter)ajax.post("friends",extend({act:"filter_friends",uid:cur.oid},cur.filter),{onDone:function(_){for(var e in cur.filterIds={},_)_.hasOwnProperty(e)&&(cur.filterIds[_[e]]=1);for(var r in cur.friendsList)"filter"==r.split("_").pop()&&delete cur.friendsList[r];inArray(cur.section,["all","online","phonebook"])||(Friends.selectTab("all"),Friends.selectSection("all"),cur.curList=cur.section="all",nav.setLoc(extend(nav.objLoc,{section:"all"}))),Friends.search(cur.searchStr||-1,cur.section,!1,!0),Friends.changeSummary(),Friends.updateCurFilters()},progress:"friends_fltr_progress",cache:1});else{cur.filterIds&&(cur.filterIds=!1);var _=cur.searchStr||"";cur.searchStr="",Friends.updateList(_),Friends.updateCurFilters()}},updateCurFilters:function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_cur_filters");if(cur.filter){for(var e in cur.filter)if(cur.filter.hasOwnProperty(e)){var r=cur.filter[e],s="",i=!1,t=!1,n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_filters_token_"+e);if(r){switch(e){case"city":s=cur.cityFilter.val_full()[1];break;case"age_from":s=cur.ageFromFilter.val_full()[1],i="age_to";break;case"age_to":s=cur.ageToFilter.val_full()[1],t="age_from";break;case"sex":s=2==r?getLang("sex_m"):getLang("sex_fm")}var o='<span class="label">'+(s=stripHTML(s))+'</span><span class="del_icon"></span>';if(n)n.innerHTML=o;else{var c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("div",{id:"friends_filters_token_"+e,className:"token",innerHTML:o,onclick:Friends.clearFilter.pbind(!0,e)});i&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_filters_token_"+i)?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domInsertBefore)(c,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_filters_token_"+i)):t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_filters_token_"+t)?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domInsertAfter)(c,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("friends_filters_token_"+t)):_.appendChild(c)}}else n&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)(n)}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)(_)}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(_),_.innerHTML=""},changeFriendsOrder:function(_,e){var r=domPN(_);"date"===e&&"date"!==nav.objLoc.sort?(nav.change({sort:!1}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(r,"friends_sort_sel_date"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(r,"friends_sort_sel_common")):"common"===e&&"common"!==nav.objLoc.sort&&(nav.change({sort:"common"}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(r,"friends_sort_sel_common"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(r,"friends_sort_sel_date"))},findAdd:function(_,e,r){ajax.post("al_friends.php",{act:"add",mid:_,hash:e,request:1,short_resp:1},{onDone:function(_){var e=r.parentNode;e.innerHTML='<div class="friends_imp_status" style="display: none;">'+_+"</div>",fadeIn(e.firstChild,200)},onFail:function(_){if(_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(getLang("global_error"),_),!0},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.lockButton.pbind(r),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_15__.unlockButton.pbind(r)})},toggleFindFilters:function(_,e){var r=e?0:200;_||(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("search_filters_minimized"),e?searcher.toggleMinimizedFilters(_,!0,e):searcher.toggleMinimizedFilters(_)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(_,"ui_rmenu_item_expanded")?(slideUp("friends_import_block",r,(function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_import_stub")})),cur.disableAutoMore=!1,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("search_row","results")&&searcher.updResults()):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("friends_import_stub","friends_filters_header","results"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("friends_import_header","friends_list_wrap"),slideDown("friends_import_block",r),nav.setLoc("friends?act=find"),val("search_query",""),cur.params&&(cur.params["c[q]"]=""),cur.disableAutoMore=!0,scrollToTop())},extendedSearchQuery:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)("search_filters_minimized","ui_rmenu_item_expanded")||Friends.toggleFindFilters(!1,!0),searcher.onEnter()},clearFindParams:function(_,e){return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("search_clear_params"),uiSearch.reset(_,!1,e)},isInvitePage:()=>{var _;return!!(null===(_=window.cur)||void 0===_?void 0:_.gid)}};function extractUserParameters(_){var e=0,r="";if("string"!=typeof _||!_)return[e,r];var s=/^id(\d+)$/.exec(_);null!==s&&(e=_slicedToArray(s,2)[1],e=Number(e),Number.isNaN(e)&&(e=0));if(!e){var i=/^(?:(?:(?:https?:\/\/)?vk.com\/)|@)(?:(?:id(\d+))|(\w|.+))$/.exec(_);if(null!==i){var t=_slicedToArray(i,3),n=t[1],o=t[2];e=Number(n),Number.isNaN(e)&&(e=0),e||(r=o)}}return[e,r]}__webpack_exports__.default=Friends}});